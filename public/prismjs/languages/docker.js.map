{"version":3,"file":"docker.js","sources":["../../src/languages/docker.js"],"sourcesContent":["/** @type {import('../types.d.ts').LanguageProto<'docker'>} */\nexport default {\n\tid: 'docker',\n\talias: 'dockerfile',\n\tgrammar () {\n\t\t// Many of the following regexes will contain negated lookaheads like `[ \\t]+(?![ \\t])`. This is a trick to ensure\n\t\t// that quantifiers behave *atomically*. Atomic quantifiers are necessary to prevent exponential backtracking.\n\n\t\tconst spaceAfterBackSlash = /\\\\[\\r\\n](?:\\s|\\\\[\\r\\n]|#.*(?!.))*(?![\\s#]|\\\\[\\r\\n])/.source;\n\t\t// At least one space, comment, or line break\n\t\tconst space = /(?:[ \\t]+(?![ \\t])(?:<SP_BS>)?|<SP_BS>)/.source.replace(\n\t\t\t/<SP_BS>/g,\n\t\t\t() => spaceAfterBackSlash\n\t\t);\n\n\t\tconst string = /\"(?:[^\"\\\\\\r\\n]|\\\\(?:\\r\\n|[\\s\\S]))*\"|'(?:[^'\\\\\\r\\n]|\\\\(?:\\r\\n|[\\s\\S]))*'/\n\t\t\t.source;\n\t\tconst option = /--[\\w-]+=(?:<STR>|(?![\"'])(?:[^\\s\\\\]|\\\\.)+)/.source.replace(\n\t\t\t/<STR>/g,\n\t\t\t() => string\n\t\t);\n\n\t\tconst stringRule = {\n\t\t\tpattern: RegExp(string),\n\t\t\tgreedy: true,\n\t\t};\n\t\tconst commentRule = {\n\t\t\tpattern: /(^[ \\t]*)#.*/m,\n\t\t\tlookbehind: true,\n\t\t\tgreedy: true,\n\t\t};\n\n\t\t/**\n\t\t * @param {string} source\n\t\t * @param {string} [flags]\n\t\t * @returns {RegExp}\n\t\t */\n\t\tfunction re (source, flags) {\n\t\t\tsource = source.replace(/<OPT>/g, () => option).replace(/<SP>/g, () => space);\n\n\t\t\treturn RegExp(source, flags);\n\t\t}\n\n\t\treturn {\n\t\t\t'instruction': {\n\t\t\t\tpattern:\n\t\t\t\t\t/(^[ \\t]*)(?:ADD|ARG|CMD|COPY|ENTRYPOINT|ENV|EXPOSE|FROM|HEALTHCHECK|LABEL|MAINTAINER|ONBUILD|RUN|SHELL|STOPSIGNAL|USER|VOLUME|WORKDIR)(?=\\s)(?:\\\\.|[^\\r\\n\\\\])*(?:\\\\$(?:\\s|#.*$)*(?![\\s#])(?:\\\\.|[^\\r\\n\\\\])*)*/im,\n\t\t\t\tlookbehind: true,\n\t\t\t\tgreedy: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'options': {\n\t\t\t\t\t\tpattern: re(/(^(?:ONBUILD<SP>)?\\w+<SP>)<OPT>(?:<SP><OPT>)*/.source, 'i'),\n\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\tgreedy: true,\n\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\t'property': {\n\t\t\t\t\t\t\t\tpattern: /(^|\\s)--[\\w-]+/,\n\t\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'string': [\n\t\t\t\t\t\t\t\tstringRule,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tpattern: /(=)(?![\"'])(?:[^\\s\\\\]|\\\\.)+/,\n\t\t\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t'operator': /\\\\$/m,\n\t\t\t\t\t\t\t'punctuation': /=/,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t'keyword': [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// https://docs.docker.com/engine/reference/builder/#healthcheck\n\t\t\t\t\t\t\tpattern: re(\n\t\t\t\t\t\t\t\t/(^(?:ONBUILD<SP>)?HEALTHCHECK<SP>(?:<OPT><SP>)*)(?:CMD|NONE)\\b/\n\t\t\t\t\t\t\t\t\t.source,\n\t\t\t\t\t\t\t\t'i'\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\tgreedy: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// https://docs.docker.com/engine/reference/builder/#from\n\t\t\t\t\t\t\tpattern: re(\n\t\t\t\t\t\t\t\t/(^(?:ONBUILD<SP>)?FROM<SP>(?:<OPT><SP>)*(?!--)[^ \\t\\\\]+<SP>)AS/\n\t\t\t\t\t\t\t\t\t.source,\n\t\t\t\t\t\t\t\t'i'\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\tgreedy: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// https://docs.docker.com/engine/reference/builder/#onbuild\n\t\t\t\t\t\t\tpattern: re(/(^ONBUILD<SP>)\\w+/.source, 'i'),\n\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\tgreedy: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpattern: /^\\w+/,\n\t\t\t\t\t\t\tgreedy: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t'comment': commentRule,\n\t\t\t\t\t'string': stringRule,\n\t\t\t\t\t'variable': /\\$(?:\\w+|\\{[^{}\"'\\\\]*\\})/,\n\t\t\t\t\t'operator': /\\\\$/m,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'comment': commentRule,\n\t\t};\n\t},\n};\n"],"names":["docker","id","alias","grammar","space","replace","string","option","stringRule","pattern","RegExp","greedy","commentRule","lookbehind","re","source","flags","instruction","inside","options","property","operator","punctuation","keyword","comment","variable"],"mappings":"AACA,IAAeA,EAAA,CACdC,GAAI,SACJC,MAAO,aACP,OAAAC,GAIC,MAEMC,EAAQ,0CAAiDC,QAC9D,YACA,IAJ2B,gEAOtBC,EAAS,+EAETC,EAAS,qDAAqDF,QACnE,UACA,IAAMC,IAGDE,EAAa,CAClBC,QAASC,OAAOJ,GAChBK,QAAQ,GAEHC,EAAc,CACnBH,QAAS,gBACTI,YAAY,EACZF,QAAQ,GAQT,SAASG,EAAIC,EAAQC,GAGpB,OAFAD,EAASA,EAAOV,QAAQ,UAAU,IAAME,IAAQF,QAAQ,SAAS,IAAMD,IAEhEM,OAAOK,EAAQC,EACzB,CAEE,MAAO,CACNC,YAAe,CACdR,QACC,kNACDI,YAAY,EACZF,QAAQ,EACRO,OAAQ,CACPC,QAAW,CACVV,QAASK,EAAG,iDAAwD,KACpED,YAAY,EACZF,QAAQ,EACRO,OAAQ,CACPE,SAAY,CACXX,QAAS,iBACTI,YAAY,GAEbP,OAAU,CACTE,EACA,CACCC,QAAS,8BACTI,YAAY,IAGdQ,SAAY,OACZC,YAAe,MAGjBC,QAAW,CACV,CAECd,QAASK,EACR,kEAEA,KAEDD,YAAY,EACZF,QAAQ,GAET,CAECF,QAASK,EACR,mEAEA,KAEDD,YAAY,EACZF,QAAQ,GAET,CAECF,QAASK,EAAG,qBAA4B,KACxCD,YAAY,EACZF,QAAQ,GAET,CACCF,QAAS,OACTE,QAAQ,IAGVa,QAAWZ,EACXN,OAAUE,EACViB,SAAY,2BACZJ,SAAY,SAGdG,QAAWZ,EAEZ"}