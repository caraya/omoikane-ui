{"version":3,"file":"diff.js","sources":["../../src/languages/diff.js"],"sourcesContent":["/**\n * A map from the name of a block to its line prefix.\n */\nexport const PREFIXES = {\n\t'deleted-sign': '-',\n\t'deleted-arrow': '<',\n\t'inserted-sign': '+',\n\t'inserted-arrow': '>',\n\t'unchanged': ' ',\n\t'diff': '!',\n};\n\n/** @type {import('../types.d.ts').LanguageProto<'diff'>} */\nexport default {\n\tid: 'diff',\n\tgrammar () {\n\t\t/** @type {import('../types.d.ts').Grammar} */\n\t\tconst diff = {\n\t\t\t'coord': [\n\t\t\t\t// Match all kinds of coord lines (prefixed by \"+++\", \"---\" or \"***\").\n\t\t\t\t/^(?:\\*{3}|-{3}|\\+{3}).*$/m,\n\t\t\t\t// Match \"@@ ... @@\" coord lines in unified diff.\n\t\t\t\t/^@@.*@@$/m,\n\t\t\t\t// Match coord lines in normal diff (starts with a number).\n\t\t\t\t/^\\d.*$/m,\n\t\t\t],\n\n\t\t\t// deleted, inserted, unchanged, diff\n\t\t};\n\n\t\t// add a token for each prefix\n\t\tObject.keys(PREFIXES).forEach(name => {\n\t\t\tconst prefix = PREFIXES[name];\n\n\t\t\tconst alias = [];\n\t\t\tconst mainName = /\\w+/.exec(name)?.[0] || name;\n\t\t\tif (mainName !== name) {\n\t\t\t\t// \"deleted-sign\" -> \"deleted\"\n\t\t\t\talias.push(mainName);\n\t\t\t}\n\t\t\tif (name === 'diff') {\n\t\t\t\talias.push('bold');\n\t\t\t}\n\n\t\t\tdiff[name] = {\n\t\t\t\tpattern: RegExp(`^(?:[${prefix}].*(?:\\r\\n?|\\n|(?![\\\\s\\\\S])))+`, 'm'),\n\t\t\t\talias,\n\t\t\t\tinside: {\n\t\t\t\t\t'prefix': {\n\t\t\t\t\t\tpattern: RegExp(`^[${prefix}]`, 'm'),\n\t\t\t\t\t\tgreedy: true,\n\t\t\t\t\t\talias: mainName,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t});\n\n\t\treturn diff;\n\t},\n};\n"],"names":["PREFIXES","unchanged","diff","id","grammar","coord","Object","keys","forEach","name","prefix","alias","mainName","exec","push","pattern","RegExp","inside","greedy"],"mappings":"AAGY,MAACA,EAAW,CACvB,eAAgB,IAChB,gBAAiB,IACjB,gBAAiB,IACjB,iBAAkB,IAClBC,UAAa,IACbC,KAAQ,KAIT,IAAeA,EAAA,CACdC,GAAI,OACJ,OAAAC,GAEC,MAAMF,EAAO,CACZG,MAAS,CAER,4BAEA,YAEA,YAiCF,OA1BAC,OAAOC,KAAKP,GAAUQ,SAAQC,IAC7B,MAAMC,EAASV,EAASS,GAElBE,EAAQ,GACRC,EAAW,MAAMC,KAAKJ,KAAQ,IAAMA,EACtCG,IAAaH,GAEhBE,EAAMG,KAAKF,GAEC,SAATH,GACHE,EAAMG,KAAK,QAGZZ,EAAKO,GAAQ,CACZM,QAASC,OAAO,QAAQN,kCAAwC,KAChEC,QACAM,OAAQ,CACPP,OAAU,CACTK,QAASC,OAAO,KAAKN,KAAW,KAChCQ,QAAQ,EACRP,MAAOC,IAGT,IAGKV,CACP"}