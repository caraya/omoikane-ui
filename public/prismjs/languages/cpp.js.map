{"version":3,"file":"cpp.js","sources":["../../src/languages/cpp.js"],"sourcesContent":["import { insertBefore } from '../util/language-util.js';\nimport c from './c.js';\n\n/** @type {import('../types.d.ts').LanguageProto<'cpp'>} */\nexport default {\n\tid: 'cpp',\n\trequire: c,\n\toptional: 'opencl-extensions',\n\tgrammar ({ extend, getOptionalLanguage }) {\n\t\tconst keyword =\n\t\t\t/\\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\\b/;\n\t\tconst modName = /\\b(?!<keyword>)\\w+(?:\\s*\\.\\s*\\w+)*\\b/.source.replace(\n\t\t\t/<keyword>/g,\n\t\t\t() => keyword.source\n\t\t);\n\n\t\tconst cpp = extend('c', {\n\t\t\t'class-name': [\n\t\t\t\t{\n\t\t\t\t\tpattern: RegExp(\n\t\t\t\t\t\t/(\\b(?:class|concept|enum|struct|typename)\\s+)(?!<keyword>)\\w+/.source.replace(\n\t\t\t\t\t\t\t/<keyword>/g,\n\t\t\t\t\t\t\t() => keyword.source\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t},\n\t\t\t\t// This is intended to capture the class name of method implementations like:\n\t\t\t\t//   void foo::bar() const {}\n\t\t\t\t// However! The `foo` in the above example could also be a namespace, so we only capture the class name if\n\t\t\t\t// it starts with an uppercase letter. This approximation should give decent results.\n\t\t\t\t/\\b[A-Z]\\w*(?=\\s*::\\s*\\w+\\s*\\()/,\n\t\t\t\t// This will capture the class name before destructors like:\n\t\t\t\t//   Foo::~Foo() {}\n\t\t\t\t/\\b[A-Z_]\\w*(?=\\s*::\\s*~\\w+\\s*\\()/i,\n\t\t\t\t// This also intends to capture the class name of method implementations but here the class has template\n\t\t\t\t// parameters, so it can't be a namespace (until C++ adds generic namespaces).\n\t\t\t\t/\\b\\w+(?=\\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\\s*::\\s*\\w+\\s*\\()/,\n\t\t\t],\n\t\t\t'keyword': keyword,\n\t\t\t'number': {\n\t\t\t\tpattern:\n\t\t\t\t\t/(?:\\b0b[01']+|\\b0x(?:[\\da-f']+(?:\\.[\\da-f']*)?|\\.[\\da-f']+)(?:p[+-]?[\\d']+)?|(?:\\b[\\d']+(?:\\.[\\d']*)?|\\B\\.[\\d']+)(?:e[+-]?[\\d']+)?)[ful]{0,4}/i,\n\t\t\t\tgreedy: true,\n\t\t\t},\n\t\t\t'operator':\n\t\t\t\t/>>=?|<<=?|->|--|\\+\\+|&&|\\|\\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\\b/,\n\t\t\t'boolean': /\\b(?:false|true)\\b/,\n\t\t});\n\n\t\tinsertBefore(cpp, 'string', {\n\t\t\t'module': {\n\t\t\t\t// https://en.cppreference.com/w/cpp/language/modules\n\t\t\t\tpattern: RegExp(\n\t\t\t\t\t/(\\b(?:import|module)\\s+)/.source +\n\t\t\t\t\t\t'(?:' +\n\t\t\t\t\t\t// header-name\n\t\t\t\t\t\t/\"(?:\\\\(?:\\r\\n|[\\s\\S])|[^\"\\\\\\r\\n])*\"|<[^<>\\r\\n]*>/.source +\n\t\t\t\t\t\t'|' +\n\t\t\t\t\t\t// module name or partition or both\n\t\t\t\t\t\t/<mod-name>(?:\\s*:\\s*<mod-name>)?|:\\s*<mod-name>/.source.replace(\n\t\t\t\t\t\t\t/<mod-name>/g,\n\t\t\t\t\t\t\t() => modName\n\t\t\t\t\t\t) +\n\t\t\t\t\t\t')'\n\t\t\t\t),\n\t\t\t\tlookbehind: true,\n\t\t\t\tgreedy: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'string': /^[<\"][\\s\\S]+/,\n\t\t\t\t\t'operator': /:/,\n\t\t\t\t\t'punctuation': /\\./,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'raw-string': {\n\t\t\t\tpattern: /R\"([^()\\\\ ]{0,16})\\([\\s\\S]*?\\)\\1\"/,\n\t\t\t\talias: 'string',\n\t\t\t\tgreedy: true,\n\t\t\t},\n\t\t});\n\n\t\tinsertBefore(cpp, 'keyword', {\n\t\t\t'generic-function': {\n\t\t\t\tpattern: /\\b(?!operator\\b)[a-z_]\\w*\\s*<(?:[^<>]|<[^<>]*>)*>(?=\\s*\\()/i,\n\t\t\t\tinside: {\n\t\t\t\t\t'function': /^\\w+/,\n\t\t\t\t\t'generic': {\n\t\t\t\t\t\tpattern: /<[\\s\\S]+/,\n\t\t\t\t\t\talias: 'class-name',\n\t\t\t\t\t\tinside: 'cpp',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tinsertBefore(cpp, 'operator', {\n\t\t\t'double-colon': {\n\t\t\t\tpattern: /::/,\n\t\t\t\talias: 'punctuation',\n\t\t\t},\n\t\t});\n\n\t\t/* OpenCL host API */\n\t\tconst extensions = getOptionalLanguage('opencl-extensions');\n\t\tif (extensions) {\n\t\t\tinsertBefore(\n\t\t\t\tcpp,\n\t\t\t\t'keyword',\n\t\t\t\t/** @type {import('../types.d.ts').GrammarTokens} */ (extensions)\n\t\t\t);\n\t\t}\n\n\t\tconst baseInside = { ...cpp };\n\t\tinsertBefore(baseInside, 'double-colon', {\n\t\t\t// All untokenized words that are not namespaces should be class names\n\t\t\t'class-name': /\\b[a-z_]\\w*\\b(?!\\s*::)/i,\n\t\t});\n\n\t\tinsertBefore(cpp, 'class-name', {\n\t\t\t// the base clause is an optional list of parent classes\n\t\t\t// https://en.cppreference.com/w/cpp/language/class\n\t\t\t'base-clause': {\n\t\t\t\tpattern:\n\t\t\t\t\t/(\\b(?:class|struct)\\s+\\w+\\s*:\\s*)[^;{}\"'\\s]+(?:\\s+[^;{}\"'\\s]+)*(?=\\s*[;{])/,\n\t\t\t\tlookbehind: true,\n\t\t\t\tgreedy: true,\n\t\t\t\tinside: baseInside,\n\t\t\t},\n\t\t});\n\n\t\treturn cpp;\n\t},\n};\n"],"names":["cpp","id","require","c","optional","grammar","extend","getOptionalLanguage","keyword","modName","replace","source","pattern","RegExp","lookbehind","number","greedy","operator","boolean","insertBefore","module","inside","string","punctuation","alias","function","generic","extensions","baseInside"],"mappings":"oHAIA,IAAeA,EAAA,CACdC,GAAI,MACJC,QAASC,EACTC,SAAU,oBACV,OAAAC,EAASC,OAAEA,EAAMC,oBAAEA,IAClB,MAAMC,EACL,osBACKC,EAAU,8CAA8CC,QAC7D,cACA,IAAMF,EAAQG,SAGTX,EAAMM,EAAO,IAAK,CACvB,aAAc,CACb,CACCM,QAASC,OACR,mEAAuEH,QACtE,cACA,IAAMF,EAAQG,UAGhBG,YAAY,GAMb,iCAGA,oCAGA,kEAEDN,QAAWA,EACXO,OAAU,CACTH,QACC,iJACDI,QAAQ,GAETC,SACC,yHACDC,QAAW,uBAGZC,EAAanB,EAAK,SAAU,CAC3BoB,OAAU,CAETR,QAASC,OACR,kFAMC,qDAAyDH,QACxD,eACA,IAAMD,IAEP,KAEFK,YAAY,EACZE,QAAQ,EACRK,OAAQ,CACPC,OAAU,eACVL,SAAY,IACZM,YAAe,OAGjB,aAAc,CACbX,QAAS,oCACTY,MAAO,SACPR,QAAQ,KAIVG,EAAanB,EAAK,UAAW,CAC5B,mBAAoB,CACnBY,QAAS,8DACTS,OAAQ,CACPI,SAAY,OACZC,QAAW,CACVd,QAAS,WACTY,MAAO,aACPH,OAAQ,WAMZF,EAAanB,EAAK,WAAY,CAC7B,eAAgB,CACfY,QAAS,KACTY,MAAO,iBAKT,MAAMG,EAAapB,EAAoB,qBACnCoB,GACHR,EACCnB,EACA,UACJ,GAIE,MAAM4B,EAAa,IAAK5B,GAkBxB,OAjBAmB,EAAaS,EAAY,eAAgB,CAExC,aAAc,4BAGfT,EAAanB,EAAK,aAAc,CAG/B,cAAe,CACdY,QACC,6EACDE,YAAY,EACZE,QAAQ,EACRK,OAAQO,KAIH5B,CACP"}