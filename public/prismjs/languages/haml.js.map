{"version":3,"file":"haml.js","sources":["../../src/languages/haml.js"],"sourcesContent":["import ruby from './ruby.js';\n\n/** @type {import('../types.d.ts').LanguageProto<'haml'>} */\nexport default {\n\tid: 'haml',\n\trequire: ruby,\n\tgrammar () {\n\t\t/* TODO\n\t\t\tHandle multiline code after tag\n\t\t\t    %foo= some |\n\t\t\t\t\tmultiline |\n\t\t\t\t\tcode |\n\t\t*/\n\n\t\tconst filter_pattern =\n\t\t\t'((?:^|\\\\r?\\\\n|\\\\r)([\\\\t ]*)):{{filter_name}}(?:(?:\\\\r?\\\\n|\\\\r)(?:\\\\2[\\\\t ].+|\\\\s*?(?=\\\\r?\\\\n|\\\\r)))+';\n\n\t\t// Non exhaustive list of available filters and associated languages\n\t\tconst filters = [\n\t\t\t'css',\n\t\t\t{ filter: 'coffee', language: 'coffeescript' },\n\t\t\t'erb',\n\t\t\t'javascript',\n\t\t\t'less',\n\t\t\t'markdown',\n\t\t\t'ruby',\n\t\t\t'scss',\n\t\t\t'textile',\n\t\t];\n\n\t\tconst all_filters = /** @type {import('../types.d.ts').GrammarTokens} */ ({});\n\t\tfor (const f of filters) {\n\t\t\tconst { filter, language } = typeof f === 'string' ? { filter: f, language: f } : f;\n\t\t\tall_filters['filter-' + filter] = {\n\t\t\t\tpattern: RegExp(filter_pattern.replace('{{filter_name}}', () => filter)),\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'filter-name': {\n\t\t\t\t\t\tpattern: /^:[\\w-]+/,\n\t\t\t\t\t\talias: 'symbol',\n\t\t\t\t\t},\n\t\t\t\t\t'text': {\n\t\t\t\t\t\tpattern: /[\\s\\S]+/,\n\t\t\t\t\t\talias: [language, 'language-' + language],\n\t\t\t\t\t\tinside: language,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\t// Multiline stuff should appear before the rest\n\n\t\t\t'multiline-comment': {\n\t\t\t\tpattern: /((?:^|\\r?\\n|\\r)([\\t ]*))(?:\\/|-#).*(?:(?:\\r?\\n|\\r)\\2[\\t ].+)*/,\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'comment',\n\t\t\t},\n\n\t\t\t'multiline-code': [\n\t\t\t\t{\n\t\t\t\t\tpattern:\n\t\t\t\t\t\t/((?:^|\\r?\\n|\\r)([\\t ]*)(?:[~-]|[&!]?=)).*,[\\t ]*(?:(?:\\r?\\n|\\r)\\2[\\t ].*,[\\t ]*)*(?:(?:\\r?\\n|\\r)\\2[\\t ].+)/,\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\tinside: 'ruby',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpattern:\n\t\t\t\t\t\t/((?:^|\\r?\\n|\\r)([\\t ]*)(?:[~-]|[&!]?=)).*\\|[\\t ]*(?:(?:\\r?\\n|\\r)\\2[\\t ].*\\|[\\t ]*)*/,\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\tinside: 'ruby',\n\t\t\t\t},\n\t\t\t],\n\n\t\t\t// See at the end of the file for known filters\n\t\t\t'filter': {\n\t\t\t\tpattern:\n\t\t\t\t\t/((?:^|\\r?\\n|\\r)([\\t ]*)):[\\w-]+(?:(?:\\r?\\n|\\r)(?:\\2[\\t ].+|\\s*?(?=\\r?\\n|\\r)))+/,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'filter-name': {\n\t\t\t\t\t\tpattern: /^:[\\w-]+/,\n\t\t\t\t\t\talias: 'symbol',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\n\t\t\t'markup': {\n\t\t\t\tpattern: /((?:^|\\r?\\n|\\r)[\\t ]*)<.+/,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: 'markup',\n\t\t\t},\n\t\t\t'doctype': {\n\t\t\t\tpattern: /((?:^|\\r?\\n|\\r)[\\t ]*)!!!(?: .+)?/,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'tag': {\n\t\t\t\t// Allows for one nested group of braces\n\t\t\t\tpattern:\n\t\t\t\t\t/((?:^|\\r?\\n|\\r)[\\t ]*)[%.#][\\w\\-#.]*[\\w\\-](?:\\([^)]+\\)|\\{(?:\\{[^}]+\\}|[^{}])+\\}|\\[[^\\]]+\\])*[\\/<>]*/,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'attributes': [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// Lookbehind tries to prevent interpolations from breaking it all\n\t\t\t\t\t\t\t// Allows for one nested group of braces\n\t\t\t\t\t\t\tpattern: /(^|[^#])\\{(?:\\{[^}]+\\}|[^{}])+\\}/,\n\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\tinside: 'ruby',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpattern: /\\([^)]+\\)/,\n\t\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\t\t'attr-value': {\n\t\t\t\t\t\t\t\t\tpattern: /(=\\s*)(?:\"(?:\\\\.|[^\\\\\"\\r\\n])*\"|[^)\\s]+)/,\n\t\t\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'attr-name': /[\\w:-]+(?=\\s*!?=|\\s*[,)])/,\n\t\t\t\t\t\t\t\t'punctuation': /[=(),]/,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpattern: /\\[[^\\]]+\\]/,\n\t\t\t\t\t\t\tinside: 'ruby',\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t'punctuation': /[<>]/,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'code': {\n\t\t\t\tpattern: /((?:^|\\r?\\n|\\r)[\\t ]*(?:[~-]|[&!]?=)).+/,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: 'ruby',\n\t\t\t},\n\t\t\t// Interpolations in plain text\n\t\t\t'interpolation': {\n\t\t\t\tpattern: /#\\{[^}]+\\}/,\n\t\t\t\tinside: {\n\t\t\t\t\t'delimiter': {\n\t\t\t\t\t\tpattern: /^#\\{|\\}$/,\n\t\t\t\t\t\talias: 'punctuation',\n\t\t\t\t\t},\n\t\t\t\t\t'ruby': {\n\t\t\t\t\t\tpattern: /[\\s\\S]+/,\n\t\t\t\t\t\tinside: 'ruby',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t'punctuation': {\n\t\t\t\tpattern: /((?:^|\\r?\\n|\\r)[\\t ]*)[~=\\-&!]+/,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t$insertBefore: {\n\t\t\t\t'filter': all_filters,\n\t\t\t},\n\t\t};\n\t},\n};\n"],"names":["haml","id","require","ruby","grammar","filters","filter","language","all_filters","f","pattern","RegExp","replace","lookbehind","inside","alias","text","markup","doctype","tag","attributes","punctuation","code","interpolation","delimiter","$insertBefore"],"mappings":"4CAGA,IAAeA,EAAA,CACdC,GAAI,OACJC,QAASC,EACT,OAAAC,GAQC,MAIMC,EAAU,CACf,MACA,CAAEC,OAAQ,SAAUC,SAAU,gBAC9B,MACA,aACA,OACA,WACA,OACA,OACA,WAGKC,EAAoE,CAAE,EAC5E,IAAK,MAAMC,KAAKJ,EAAS,CACxB,MAAMC,OAAEA,EAAMC,SAAEA,GAA0B,iBAANE,EAAiB,CAAEH,OAAQG,EAAGF,SAAUE,GAAMA,EAClFD,EAAY,UAAYF,GAAU,CACjCI,QAASC,OAnBV,uGAmBgCC,QAAQ,mBAAmB,IAAMN,KAChEO,YAAY,EACZC,OAAQ,CACP,cAAe,CACdJ,QAAS,WACTK,MAAO,UAERC,KAAQ,CACPN,QAAS,UACTK,MAAO,CAACR,EAAU,YAAcA,GAChCO,OAAQP,IAId,CAEE,MAAO,CAGN,oBAAqB,CACpBG,QAAS,gEACTG,YAAY,EACZE,MAAO,WAGR,iBAAkB,CACjB,CACCL,QACC,6GACDG,YAAY,EACZC,OAAQ,QAET,CACCJ,QACC,sFACDG,YAAY,EACZC,OAAQ,SAKVR,OAAU,CACTI,QACC,iFACDG,YAAY,EACZC,OAAQ,CACP,cAAe,CACdJ,QAAS,WACTK,MAAO,YAKVE,OAAU,CACTP,QAAS,4BACTG,YAAY,EACZC,OAAQ,UAETI,QAAW,CACVR,QAAS,oCACTG,YAAY,GAEbM,IAAO,CAENT,QACC,sGACDG,YAAY,EACZC,OAAQ,CACPM,WAAc,CACb,CAGCV,QAAS,mCACTG,YAAY,EACZC,OAAQ,QAET,CACCJ,QAAS,YACTI,OAAQ,CACP,aAAc,CACbJ,QAAS,0CACTG,YAAY,GAEb,YAAa,4BACbQ,YAAe,WAGjB,CACCX,QAAS,aACTI,OAAQ,SAGVO,YAAe,SAGjBC,KAAQ,CACPZ,QAAS,0CACTG,YAAY,EACZC,OAAQ,QAGTS,cAAiB,CAChBb,QAAS,aACTI,OAAQ,CACPU,UAAa,CACZd,QAAS,WACTK,MAAO,eAERZ,KAAQ,CACPO,QAAS,UACTI,OAAQ,UAIXO,YAAe,CACdX,QAAS,kCACTG,YAAY,GAEbY,cAAe,CACdnB,OAAUE,GAGZ"}