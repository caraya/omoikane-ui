{"version":3,"file":"line-highlight.js","sources":["../../src/plugins/line-highlight/line-highlight.js"],"sourcesContent":["import prism from '../../global.js';\nimport { isActive } from '../../shared/dom-util.js';\nimport { lazy, noop } from '../../shared/util.js';\nimport { combineCallbacks } from '../../util/combine-callbacks.js';\n\nconst LINE_NUMBERS_CLASS = 'line-numbers';\nconst LINKABLE_LINE_NUMBERS_CLASS = 'linkable-line-numbers';\nconst NEW_LINE_EXP = /\\n(?!$)/g;\n\n/**\n *\n * @param {string} selector\n * @param {ParentNode} [container=document]\n * @returns {Element[]}\n */\nfunction $$ (selector, container = document) {\n\treturn [...container.querySelectorAll(selector)];\n}\n\n/**\n * Returns the top offset of the content box of the given parent and the content box of one of its children.\n *\n * @param {HTMLElement} parent\n * @param {HTMLElement} child\n * @returns {number}\n */\nfunction getContentBoxTopOffset (parent, child) {\n\tconst parentStyle = getComputedStyle(parent);\n\tconst childStyle = getComputedStyle(child);\n\n\t/**\n\t * Returns the numeric value of the given pixel value.\n\t *\n\t * @param {string} px\n\t * @returns {number}\n\t */\n\tfunction pxToNumber (px) {\n\t\treturn +px.substr(0, px.length - 2);\n\t}\n\n\treturn (\n\t\tchild.offsetTop +\n\t\tpxToNumber(childStyle.borderTopWidth) +\n\t\tpxToNumber(childStyle.paddingTop) -\n\t\tpxToNumber(parentStyle.paddingTop)\n\t);\n}\n\n/**\n * Returns whether the given element has the given class.\n *\n * @param {Element} element\n * @param {string} className\n * @returns {boolean}\n */\nfunction hasClass (element, className) {\n\treturn element.classList.contains(className);\n}\n\n/**\n * Calls the given function.\n *\n * @param {() => void} func\n * @returns {void}\n */\nfunction callFunction (func) {\n\tfunc();\n}\n\n// Some browsers round the line-height, others don't.\n// We need to test for it to position the elements properly.\nconst isLineHeightRounded = lazy(() => {\n\tconst d = document.createElement('div');\n\td.style.fontSize = '13px';\n\td.style.lineHeight = '1.5';\n\td.style.padding = '0';\n\td.style.border = '0';\n\td.innerHTML = '&nbsp;<br />&nbsp;';\n\tdocument.body.appendChild(d);\n\t// Browsers that round the line-height should have offsetHeight === 38\n\t// The others should have 39.\n\tconst result = d.offsetHeight === 38;\n\tdocument.body.removeChild(d);\n\treturn result;\n});\n\nexport class LineHighlight {\n\t/**\n\t * @package\n\t */\n\tscrollIntoView = true;\n\t/** @type {Prism} */\n\tPrism;\n\n\t/**\n\t * @param {Prism} Prism\n\t */\n\tconstructor (Prism) {\n\t\tthis.Prism = Prism;\n\t}\n\t/**\n\t * Highlights the lines of the given pre.\n\t *\n\t * This function is split into a DOM measuring and mutate phase to improve performance.\n\t * The returned function mutates the DOM when called.\n\t *\n\t * @param {HTMLElement} pre\n\t * @param {string | null} [lines]\n\t * @param {string} [classes='']\n\t */\n\thighlightLines (pre, lines, classes = '') {\n\t\tlines = typeof lines === 'string' ? lines : pre.getAttribute('data-line') || '';\n\n\t\tconst ranges = lines.replace(/\\s+/g, '').split(',').filter(Boolean);\n\t\tconst offset = Number(pre.getAttribute('data-line-offset')) || 0;\n\n\t\tconst parseMethod = isLineHeightRounded() ? parseInt : parseFloat;\n\t\tconst lineHeight = parseMethod(getComputedStyle(pre).lineHeight);\n\t\tconst hasLineNumbers = isActive(pre, LINE_NUMBERS_CLASS);\n\t\tconst codeElement = pre.querySelector('code');\n\t\tconst parentElement = hasLineNumbers ? pre : codeElement || pre;\n\t\t/** @type {(function():void)[]} */\n\t\tconst mutateActions = [];\n\t\tconst lineBreakMatch = codeElement?.textContent?.match(NEW_LINE_EXP);\n\t\tconst numberOfLines = lineBreakMatch ? lineBreakMatch.length + 1 : 1;\n\t\t/**\n\t\t * The top offset between the content box of the <code> element and the content box of the parent element of\n\t\t * the line highlight element (either `<pre>` or `<code>`).\n\t\t *\n\t\t * This offset might not be zero for some themes where the <code> element has a top margin. Some plugins\n\t\t * (or users) might also add element above the <code> element. Because the line highlight is aligned relative\n\t\t * to the <pre> element, we have to take this into account.\n\t\t *\n\t\t * This offset will be 0 if the parent element of the line highlight element is the `<code>` element.\n\t\t */\n\t\tconst codePreOffset =\n\t\t\t!codeElement || parentElement === codeElement\n\t\t\t\t? 0\n\t\t\t\t: getContentBoxTopOffset(pre, codeElement);\n\n\t\tranges.forEach(currentRange => {\n\t\t\tconst range = currentRange.split('-');\n\n\t\t\tconst start = +range[0];\n\t\t\tlet end = +range[1] || start;\n\t\t\tend = Math.min(numberOfLines + offset, end);\n\n\t\t\tif (end < start) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/** @type {HTMLElement} */\n\t\t\tconst line =\n\t\t\t\tpre.querySelector('.line-highlight[data-range=\"' + currentRange + '\"]') ||\n\t\t\t\tdocument.createElement('div');\n\n\t\t\tmutateActions.push(() => {\n\t\t\t\tline.setAttribute('aria-hidden', 'true');\n\t\t\t\tline.setAttribute('data-range', currentRange);\n\t\t\t\tline.className = classes + ' line-highlight';\n\t\t\t});\n\n\t\t\t// if the line-numbers plugin is enabled, then there is no reason for this plugin to display the line numbers\n\t\t\tif (hasLineNumbers && this.Prism.pluginRegistry.peek('line-numbers')?.plugin) {\n\t\t\t\t/** @type {LineNumbers} */\n\t\t\t\tconst lineNumbers = this.Prism.pluginRegistry.peek('line-numbers')?.plugin;\n\t\t\t\tconst startNode = lineNumbers.getLine(pre, start);\n\t\t\t\tconst endNode = lineNumbers.getLine(pre, end);\n\n\t\t\t\tif (startNode) {\n\t\t\t\t\tconst top = `${startNode.offsetTop + codePreOffset}px`;\n\t\t\t\t\tmutateActions.push(() => {\n\t\t\t\t\t\tline.style.top = top;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (startNode && endNode) {\n\t\t\t\t\tconst height = `${endNode.offsetTop - startNode.offsetTop + endNode.offsetHeight}px`;\n\t\t\t\t\tmutateActions.push(() => {\n\t\t\t\t\t\tline.style.height = height;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmutateActions.push(() => {\n\t\t\t\t\tline.setAttribute('data-start', String(start));\n\n\t\t\t\t\tif (end > start) {\n\t\t\t\t\t\tline.setAttribute('data-end', String(end));\n\t\t\t\t\t}\n\n\t\t\t\t\tline.style.top = `${(start - offset - 1) * lineHeight + codePreOffset}px`;\n\n\t\t\t\t\tline.textContent = new Array(end - start + 2).join(' \\n');\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tmutateActions.push(() => {\n\t\t\t\tline.style.width = `${pre.scrollWidth}px`;\n\t\t\t});\n\n\t\t\tmutateActions.push(() => {\n\t\t\t\t// allow this to play nicely with the line-numbers plugin\n\t\t\t\t// need to attack to pre as when line-numbers is enabled, the code tag is relatively which screws up the positioning\n\t\t\t\tparentElement.appendChild(line);\n\t\t\t});\n\t\t});\n\n\t\tconst id = pre.id;\n\t\tif (\n\t\t\thasLineNumbers &&\n\t\t\tthis.Prism.pluginRegistry.peek('line-numbers')?.plugin &&\n\t\t\tisActive(pre, LINKABLE_LINE_NUMBERS_CLASS) &&\n\t\t\tid\n\t\t) {\n\t\t\t// This implements linkable line numbers. Linkable line numbers use Line Highlight to create a link to a\n\t\t\t// specific line. For this to work, the pre element has to:\n\t\t\t//  1) have line numbers,\n\t\t\t//  2) have the `linkable-line-numbers` class or an ascendant that has that class, and\n\t\t\t//  3) have an id.\n\n\t\t\tif (!hasClass(pre, LINKABLE_LINE_NUMBERS_CLASS)) {\n\t\t\t\t// add class to pre\n\t\t\t\tmutateActions.push(() => {\n\t\t\t\t\tpre.classList.add(LINKABLE_LINE_NUMBERS_CLASS);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst start = parseInt(pre.getAttribute('data-start') || '1');\n\n\t\t\t// iterate all line number spans\n\t\t\t/** @type {LineNumbers} */\n\t\t\tconst lineNumbers = this.Prism.pluginRegistry.peek('line-numbers')?.plugin;\n\t\t\tlineNumbers.getLines(pre)?.forEach((lineSpan, i) => {\n\t\t\t\tconst lineNumber = i + start;\n\t\t\t\tlineSpan.onclick = () => {\n\t\t\t\t\tconst hash = `${id}.${lineNumber}`;\n\n\t\t\t\t\t// this will prevent scrolling since the span is obviously in view\n\t\t\t\t\tthis.scrollIntoView = false;\n\t\t\t\t\tlocation.hash = hash;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.scrollIntoView = true;\n\t\t\t\t\t}, 1);\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\treturn function () {\n\t\t\tmutateActions.forEach(callFunction);\n\t\t};\n\t}\n}\n\n/** @type {import('../../types.d.ts').PluginProto<'line-highlight'>} */\nconst Self = {\n\tid: 'line-highlight',\n\toptional: 'line-numbers',\n\tplugin (Prism) {\n\t\treturn new LineHighlight(Prism);\n\t},\n\teffect (Prism) {\n\t\tif (typeof document === 'undefined') {\n\t\t\treturn noop;\n\t\t}\n\n\t\t/**\n\t\t * Returns whether the Line Highlight plugin is active for the given element.\n\t\t *\n\t\t * If this function returns `false`, do not call `highlightLines` for the given element.\n\t\t *\n\t\t * @param {Element | null | undefined} pre\n\t\t * @returns {pre is HTMLPreElement}\n\t\t */\n\t\tfunction isActiveFor (pre) {\n\t\t\tif (!pre || !/pre/i.test(pre.nodeName)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (pre.hasAttribute('data-line')) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (pre.id && isActive(pre, LINKABLE_LINE_NUMBERS_CLASS)) {\n\t\t\t\t// Technically, the line numbers plugin is also necessary but this plugin doesn't control the classes of\n\t\t\t\t// the line numbers plugin, so we can't assume that they are present.\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tconst applyHash = () => {\n\t\t\tconst hash = location.hash.slice(1);\n\n\t\t\t// Remove pre-existing temporary lines\n\t\t\t$$('.temporary.line-highlight').forEach(line => {\n\t\t\t\tline.remove();\n\t\t\t});\n\n\t\t\tconst range = (hash.match(/\\.([\\d,-]+)$/) || [, ''])[1];\n\n\t\t\tif (!range || document.getElementById(hash)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst id = hash.slice(0, hash.lastIndexOf('.'));\n\t\t\tconst pre = document.getElementById(id);\n\n\t\t\tif (!pre) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!pre.hasAttribute('data-line')) {\n\t\t\t\tpre.setAttribute('data-line', '');\n\t\t\t}\n\n\t\t\t/** @type {LineHighlight} */\n\t\t\tconst lineHighlight = Prism.pluginRegistry.peek(Self)?.plugin;\n\t\t\tconst mutateDom = lineHighlight.highlightLines(pre, range, 'temporary ');\n\t\t\tmutateDom();\n\n\t\t\tif (lineHighlight.scrollIntoView) {\n\t\t\t\tdocument.querySelector('.temporary.line-highlight')?.scrollIntoView();\n\t\t\t}\n\t\t};\n\t\tconst onResize = () => {\n\t\t\t$$('pre')\n\t\t\t\t.filter(isActiveFor)\n\t\t\t\t.map(pre => {\n\t\t\t\t\t/** @type {LineHighlight} */\n\t\t\t\t\tconst lineHighlight = Prism.pluginRegistry.peek(Self)?.plugin;\n\t\t\t\t\treturn lineHighlight.highlightLines(pre);\n\t\t\t\t})\n\t\t\t\t.forEach(callFunction);\n\t\t};\n\n\t\twindow.addEventListener('hashchange', applyHash);\n\t\twindow.addEventListener('resize', onResize);\n\n\t\tconst removeEventListeners = () => {\n\t\t\twindow.removeEventListener('hashchange', applyHash);\n\t\t\twindow.removeEventListener('resize', onResize);\n\t\t};\n\n\t\t/** @type {number | NodeJS.Timeout | undefined} */\n\t\tlet fakeTimer = undefined; // Hack to limit the number of times applyHash() runs\n\n\t\tconst beforeSanityHook = Prism.hooks.add('before-sanity-check', env => {\n\t\t\tconst pre = env.element.parentElement;\n\t\t\tif (!isActiveFor(pre)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * Cleanup for other plugins (e.g. autoloader).\n\t\t\t *\n\t\t\t * Sometimes <code> blocks are highlighted multiple times. It is necessary\n\t\t\t * to cleanup any left-over tags, because the whitespace inside of the <div>\n\t\t\t * tags change the content of the <code> tag.\n\t\t\t */\n\t\t\tlet num = 0;\n\t\t\t$$('.line-highlight', pre).forEach(line => {\n\t\t\t\tnum += (line.textContent || '').length;\n\t\t\t\tline.remove();\n\t\t\t});\n\t\t\t// Remove extra whitespace\n\t\t\tif (num && /^(?: \\n)+$/.test(env.code.slice(-num))) {\n\t\t\t\tenv.code = env.code.slice(0, -num);\n\t\t\t}\n\t\t});\n\n\t\tconst completeHook = Prism.hooks.add('complete', env => {\n\t\t\tconst pre = env.element.parentElement;\n\t\t\tif (!isActiveFor(pre)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (fakeTimer !== undefined) {\n\t\t\t\tclearTimeout(fakeTimer);\n\t\t\t}\n\n\t\t\t/** @type {LineHighlight} */\n\t\t\tconst lineHighlight = Prism.pluginRegistry.peek(Self)?.plugin;\n\t\t\tconst mutateDom = lineHighlight.highlightLines(pre);\n\t\t\tmutateDom();\n\t\t\tfakeTimer = setTimeout(applyHash, 1);\n\t\t});\n\n\t\treturn combineCallbacks(removeEventListeners, beforeSanityHook, completeHook);\n\t},\n};\n\nexport default Self;\n\nprism.pluginRegistry.add(Self);\n\n/**\n * @typedef {import('../../core.js').Prism} Prism\n * @typedef {import('../line-numbers/line-numbers.js').LineNumbers} LineNumbers\n */\n"],"names":["LINKABLE_LINE_NUMBERS_CLASS","NEW_LINE_EXP","$$","selector","container","document","querySelectorAll","callFunction","func","isLineHeightRounded","lazy","d","createElement","style","fontSize","lineHeight","padding","border","innerHTML","body","appendChild","result","offsetHeight","removeChild","LineHighlight","scrollIntoView","Prism","constructor","this","highlightLines","pre","lines","classes","ranges","getAttribute","replace","split","filter","Boolean","offset","parseInt","parseFloat","getComputedStyle","hasLineNumbers","isActive","codeElement","querySelector","parentElement","mutateActions","lineBreakMatch","textContent","match","numberOfLines","length","codePreOffset","parent","child","parentStyle","childStyle","pxToNumber","px","substr","offsetTop","borderTopWidth","paddingTop","getContentBoxTopOffset","forEach","currentRange","range","start","end","Math","min","line","push","setAttribute","className","pluginRegistry","peek","plugin","lineNumbers","startNode","getLine","endNode","top","height","String","Array","join","width","scrollWidth","id","classList","contains","add","getLines","lineSpan","i","lineNumber","onclick","hash","location","setTimeout","Self","optional","effect","noop","isActiveFor","test","nodeName","hasAttribute","applyHash","slice","remove","getElementById","lastIndexOf","lineHighlight","mutateDom","onResize","map","fakeTimer","window","addEventListener","beforeSanityHook","hooks","env","element","num","code","completeHook","undefined","clearTimeout","combineCallbacks","removeEventListener","prism"],"mappings":"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"}