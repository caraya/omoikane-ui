import{p as t,s as e}from"../prism-DU08x7FD.js";import"../util-DdJteTVJ.js";import"../token-Dozwbq7Q.js";import"../insert-CpDsPTVw.js";import"../iterables-BnTatl6v.js";const s={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},n="data-src-status",i="loading",r="loaded",a="pre[data-src]:not(["+n+'="'+r+'"]):not(['+n+'="'+i+'"])';class FileHighlight{Prism;constructor(t){this.Prism=t}highlight(t=document){const e=t.querySelectorAll(a);for(const t of e)this.Prism.highlightElement(t)}}const o={id:"file-highlight",plugin:t=>new FileHighlight(t),effect:t=>t.hooks.add({"before-highlightall":t=>{t.selector+=", "+a},"before-sanity-check":o=>{const l=o.element;if(!l.matches(a))return;const h=l.getAttribute("data-src");if(!h)return;o.code="",l.setAttribute(n,i);const c=l.appendChild(document.createElement("CODE"));c.textContent="Loading…";let g=o.language;if("none"===g){const t=/\.(\w+)$/.exec(h)?.[1]||"none";g=s[t]||t}e(c,g),e(l,g);const u=t.pluginRegistry.peek("autoloader")?.plugin;u&&u.preloadLanguages(g),((e,s,i)=>{const a=new XMLHttpRequest;a.open("GET",e,!0),a.onreadystatechange=()=>{4===a.readyState&&(a.status<400&&a.responseText?(e=>{l.setAttribute(n,r);const s=(t=>{const e=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(t||"");if(e){const t=+e[1],s=e[2],n=e[3];return s?n?[t,+n]:[t,void 0]:[t,t]}})(l.getAttribute("data-range"));if(s){const t=e.split(/\r\n?|\n/);let n=s[0],i=null==s[1]?t.length:s[1];n<0&&(n+=t.length),n=Math.max(0,Math.min(n-1,t.length)),i<0&&(i+=t.length),i=Math.max(0,Math.min(i,t.length)),e=t.slice(n,i).join("\n"),l.hasAttribute("data-start")||l.setAttribute("data-start",n+1+"")}c.textContent=e,t.highlightElement(c)})(a.responseText):a.status>=400?i(`✖ Error ${a.status} while fetching file: ${a.statusText}`):i("✖ Error: File does not exist or is empty"))},a.send(null)})(h,0,(t=>{l.setAttribute(n,"failed"),c.textContent=t}))}})};t.pluginRegistry.add(o);export{FileHighlight,o as default};
