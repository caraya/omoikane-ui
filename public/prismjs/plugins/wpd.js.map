{"version":3,"file":"wpd.js","sources":["../../src/plugins/wpd/wpd.js"],"sourcesContent":["import prism from '../../global.js';\nimport cssSelector from '../../languages/css-selector.js';\n\nconst htmlTags = new Set([\n\t'a',\n\t'abbr',\n\t'acronym',\n\t'b',\n\t'basefont',\n\t'bdo',\n\t'big',\n\t'blink',\n\t'cite',\n\t'code',\n\t'dfn',\n\t'em',\n\t'kbd',\n\t'i',\n\t'rp',\n\t'rt',\n\t'ruby',\n\t's',\n\t'samp',\n\t'small',\n\t'spacer',\n\t'strike',\n\t'strong',\n\t'sub',\n\t'sup',\n\t'time',\n\t'tt',\n\t'u',\n\t'var',\n\t'wbr',\n\t'noframes',\n\t'summary',\n\t'command',\n\t'dt',\n\t'dd',\n\t'figure',\n\t'figcaption',\n\t'center',\n\t'section',\n\t'nav',\n\t'article',\n\t'aside',\n\t'hgroup',\n\t'header',\n\t'footer',\n\t'address',\n\t'noscript',\n\t'isIndex',\n\t'main',\n\t'mark',\n\t'marquee',\n\t'meter',\n\t'menu',\n]);\nconst svgTags = new Set([\n\t'animateColor',\n\t'animateMotion',\n\t'animateTransform',\n\t'glyph',\n\t'feBlend',\n\t'feColorMatrix',\n\t'feComponentTransfer',\n\t'feFuncR',\n\t'feFuncG',\n\t'feFuncB',\n\t'feFuncA',\n\t'feComposite',\n\t'feConvolveMatrix',\n\t'feDiffuseLighting',\n\t'feDisplacementMap',\n\t'feFlood',\n\t'feGaussianBlur',\n\t'feImage',\n\t'feMerge',\n\t'feMergeNode',\n\t'feMorphology',\n\t'feOffset',\n\t'feSpecularLighting',\n\t'feTile',\n\t'feTurbulence',\n\t'feDistantLight',\n\t'fePointLight',\n\t'feSpotLight',\n\t'linearGradient',\n\t'radialGradient',\n\t'altGlyph',\n\t'textPath',\n\t'tref',\n\t'altglyph',\n\t'textpath',\n\t'altglyphdef',\n\t'altglyphitem',\n\t'clipPath',\n\t'color-profile',\n\t'cursor',\n\t'font-face',\n\t'font-face-format',\n\t'font-face-name',\n\t'font-face-src',\n\t'font-face-uri',\n\t'foreignObject',\n\t'glyphRef',\n\t'hkern',\n\t'vkern',\n]);\nconst mathmlTags = new Set();\n\n/**\n * @param {string} tag\n * @returns {string | null}\n */\nfunction getLanguage (tag) {\n\tconst tagL = tag.toLowerCase();\n\n\tif (htmlTags.has(tagL)) {\n\t\treturn 'html';\n\t}\n\telse if (svgTags.has(tag)) {\n\t\treturn 'svg';\n\t}\n\telse if (mathmlTags.has(tag)) {\n\t\treturn 'mathml';\n\t}\n\n\t// Not in dictionary, perform check\n\n\tif (typeof document !== 'undefined') {\n\t\tconst htmlInterface = (document\n\t\t\t.createElement(tag)\n\t\t\t.toString()\n\t\t\t.match(/\\[object HTML(.+)Element\\]/) || [])[1];\n\t\tif (htmlInterface && htmlInterface !== 'Unknown') {\n\t\t\thtmlTags.add(tagL);\n\t\t\treturn 'html';\n\t\t}\n\n\t\tconst svgInterface = (document\n\t\t\t.createElementNS('http://www.w3.org/2000/svg', tag)\n\t\t\t.toString()\n\t\t\t.match(/\\[object SVG(.+)Element\\]/) || [])[1];\n\t\tif (svgInterface && svgInterface !== 'Unknown') {\n\t\t\tsvgTags.add(tag);\n\t\t\treturn 'svg';\n\t\t}\n\t}\n\n\t// Lame way to detect MathML, but browsers don't expose interface names there :(\n\tif (tag.startsWith('m')) {\n\t\tmathmlTags.add(tag);\n\t\treturn 'mathml';\n\t}\n\n\treturn null;\n}\n\n/** @type {import('../../types.d.ts').PluginProto<'wpd'>} */\nconst Self = {\n\tid: 'wpd',\n\trequire: cssSelector,\n\teffect (Prism) {\n\t\treturn Prism.hooks.add('wrap', env => {\n\t\t\tlet href = 'https://webplatform.github.io/docs/';\n\t\t\tlet content = env.content;\n\n\t\t\tif (/[<&]/.test(content)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst lang = Prism.languageRegistry.resolveRef(env.language).id;\n\t\t\tif (lang === 'css' || lang === 'scss') {\n\t\t\t\thref += 'css/';\n\n\t\t\t\tif (env.type === 'property' && !content.startsWith('-')) {\n\t\t\t\t\thref += 'properties/';\n\t\t\t\t}\n\t\t\t\telse if (env.type === 'rule' && !content.startsWith('@-')) {\n\t\t\t\t\thref += 'atrules/';\n\t\t\t\t\tcontent = content.substring(1);\n\t\t\t\t}\n\t\t\t\telse if (env.type === 'pseudo-class' && !content.startsWith(':-')) {\n\t\t\t\t\thref += 'selectors/pseudo-classes/';\n\t\t\t\t\tcontent = content.substring(1);\n\t\t\t\t}\n\t\t\t\telse if (env.type === 'pseudo-element' && !content.startsWith('::-')) {\n\t\t\t\t\thref += 'selectors/pseudo-elements/';\n\t\t\t\t\tcontent = content.substring(2);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (lang === 'markup') {\n\t\t\t\tif (env.type === 'tag' && /^[\\w-]+$/.test(content)) {\n\t\t\t\t\t// Check language\n\t\t\t\t\tconst language = getLanguage(content);\n\n\t\t\t\t\tif (language) {\n\t\t\t\t\t\thref += language + '/elements/';\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn; // Abort\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\thref += content;\n\t\t\tenv.tag = 'a';\n\t\t\tenv.attributes.href = href;\n\t\t\tenv.attributes.target = '_blank';\n\t\t});\n\t},\n};\n\nexport default Self;\n\nprism.pluginRegistry.add(Self);\n"],"names":["htmlTags","Set","svgTags","mathmlTags","Self","id","require","cssSelector","effect","Prism","hooks","add","env","href","content","test","lang","languageRegistry","resolveRef","language","type","startsWith","substring","tag","tagL","toLowerCase","has","document","htmlInterface","createElement","toString","match","svgInterface","createElementNS","getLanguage","attributes","target","prism","pluginRegistry"],"mappings":"6MAGA,MAAMA,EAAW,IAAIC,IAAI,CACxB,IACA,OACA,UACA,IACA,WACA,MACA,MACA,QACA,OACA,OACA,MACA,KACA,MACA,IACA,KACA,KACA,OACA,IACA,OACA,QACA,SACA,SACA,SACA,MACA,MACA,OACA,KACA,IACA,MACA,MACA,WACA,UACA,UACA,KACA,KACA,SACA,aACA,SACA,UACA,MACA,UACA,QACA,SACA,SACA,SACA,UACA,WACA,UACA,OACA,OACA,UACA,QACA,SAEKC,EAAU,IAAID,IAAI,CACvB,eACA,gBACA,mBACA,QACA,UACA,gBACA,sBACA,UACA,UACA,UACA,UACA,cACA,mBACA,oBACA,oBACA,UACA,iBACA,UACA,UACA,cACA,eACA,WACA,qBACA,SACA,eACA,iBACA,eACA,cACA,iBACA,iBACA,WACA,WACA,OACA,WACA,WACA,cACA,eACA,WACA,gBACA,SACA,YACA,mBACA,iBACA,gBACA,gBACA,gBACA,WACA,QACA,UAEKE,EAAa,IAAIF,IAmDjBG,EAAO,CACZC,GAAI,MACJC,QAASC,EACTC,OAAQC,GACAA,EAAMC,MAAMC,IAAI,QAAQC,IAC9B,IAAIC,EAAO,sCACPC,EAAUF,EAAIE,QAElB,GAAI,OAAOC,KAAKD,GACf,OAGD,MAAME,EAAOP,EAAMQ,iBAAiBC,WAAWN,EAAIO,UAAUd,GAC7D,GAAa,QAATW,GAA2B,SAATA,EAGrB,GAFAH,GAAQ,OAES,aAAbD,EAAIQ,MAAwBN,EAAQO,WAAW,KAG9C,GAAiB,SAAbT,EAAIQ,MAAoBN,EAAQO,WAAW,MAI/C,GAAiB,iBAAbT,EAAIQ,MAA4BN,EAAQO,WAAW,MAIvD,IAAiB,mBAAbT,EAAIQ,MAA8BN,EAAQO,WAAW,OAK7D,OAJAR,GAAQ,6BACRC,EAAUA,EAAQQ,UAAU,EAIjC,MATKT,GAAQ,4BACRC,EAAUA,EAAQQ,UAAU,QAL5BT,GAAQ,WACRC,EAAUA,EAAQQ,UAAU,QAJ5BT,GAAQ,kBAkBL,IAAa,WAATG,EAiBR,OAhBA,GAAiB,QAAbJ,EAAIQ,OAAkB,WAAWL,KAAKD,GAYzC,OAZmD,CAEnD,MAAMK,EAnFX,CAAsBI,IACrB,MAAMC,EAAOD,EAAIE,cAEjB,GAAIzB,EAAS0B,IAAIF,GAChB,MAAO,OAEH,GAAItB,EAAQwB,IAAIH,GACpB,MAAO,MAEH,GAAIpB,EAAWuB,IAAIH,GACvB,MAAO,SAKR,GAAwB,oBAAbI,SAA0B,CACpC,MAAMC,GAAiBD,SACrBE,cAAcN,GACdO,WACAC,MAAM,+BAAiC,IAAI,GAC7C,GAAIH,GAAmC,YAAlBA,EAEpB,OADA5B,EAASW,IAAIa,GACN,OAGR,MAAMQ,GAAgBL,SACpBM,gBAAgB,6BAA8BV,GAC9CO,WACAC,MAAM,8BAAgC,IAAI,GAC5C,GAAIC,GAAiC,YAAjBA,EAEnB,OADA9B,EAAQS,IAAIY,GACL,KAEV,CAGC,OAAIA,EAAIF,WAAW,MAClBlB,EAAWQ,IAAIY,GACR,UAGD,IACR,EAyCsBW,CAAYpB,GAE7B,IAAIK,EAIH,OAHAN,GAAQM,EAAW,YAKzB,CAOA,CAEGN,GAAQC,EACRF,EAAIW,IAAM,IACVX,EAAIuB,WAAWtB,KAAOA,EACtBD,EAAIuB,WAAWC,OAAS,QAAQ,KAOnCC,EAAMC,eAAe3B,IAAIP"}