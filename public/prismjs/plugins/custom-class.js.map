{"version":3,"file":"custom-class.js","sources":["../../src/plugins/custom-class/custom-class.js"],"sourcesContent":["import prism from '../../global.js';\n\nexport class CustomClass {\n\t/**\n\t * @type {ClassAdder | undefined}\n\t */\n\tadder;\n\n\t/**\n\t * @type {ClassMapper | undefined}\n\t */\n\tmapper;\n\n\t/**\n\t * A prefix to add to all class names.\n\t *\n\t * @type {string}\n\t * @default ''\n\t */\n\tprefix = '';\n\n\t/**\n\t * Sets the function which can be used to add custom aliases to any token.\n\t *\n\t * @param {ClassAdder} classAdder\n\t */\n\tadd (classAdder) {\n\t\tthis.adder = classAdder;\n\t}\n\n\t/**\n\t * Maps all class names using the given object or map function.\n\t *\n\t * This does not affect the prefix.\n\t *\n\t * @param {object | ClassMapper} classMapper\n\t */\n\tmap (classMapper) {\n\t\tif (typeof classMapper === 'function') {\n\t\t\tthis.mapper = classMapper;\n\t\t}\n\t\telse {\n\t\t\tthis.mapper = className => classMapper[className] || className;\n\t\t}\n\t}\n\n\t/**\n\t * Applies the current mapping and prefix to the given class name.\n\t *\n\t * @param {string} className A single class name.\n\t * @returns {string}\n\t */\n\tapply (className) {\n\t\treturn this.prefix + (this.mapper ? this.mapper(className) : className);\n\t}\n}\n\n/** @type {import('../../types.d.ts').PluginProto<'custom-class'>} */\nconst Self = {\n\tid: 'custom-class',\n\tplugin () {\n\t\treturn new CustomClass();\n\t},\n\teffect (Prism) {\n\t\t/** @type {CustomClass} */\n\t\tconst customClass = Prism.pluginRegistry.peek(Self)?.plugin;\n\n\t\treturn Prism.hooks.add('wrap', env => {\n\t\t\tif (customClass['adder']) {\n\t\t\t\tconst result = customClass['adder']({\n\t\t\t\t\tcontent: env.content,\n\t\t\t\t\ttype: env.type,\n\t\t\t\t\tlanguage: env.language,\n\t\t\t\t});\n\n\t\t\t\tif (Array.isArray(result)) {\n\t\t\t\t\tenv.classes.push(...result);\n\t\t\t\t}\n\t\t\t\telse if (result) {\n\t\t\t\t\tenv.classes.push(result);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!customClass['mapper'] && !customClass.prefix) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tenv.classes = env.classes.map(c => customClass.apply(c));\n\t\t});\n\t},\n};\n\nexport default Self;\n\nprism.pluginRegistry.add(Self);\n\n/**\n * @callback ClassMapper\n * @param {string} className\n * @returns {string}\n */\n\n/**\n * @callback ClassAdder\n * @param {ClassAdderEnvironment} env\n * @returns {undefined | string | string[]}\n */\n\n/**\n * @typedef {object} ClassAdderEnvironment\n * @property {string} language\n * @property {string} type\n * @property {string} content\n */\n"],"names":["CustomClass","adder","mapper","prefix","add","classAdder","this","map","classMapper","className","apply","Self","id","plugin","effect","Prism","customClass","pluginRegistry","peek","hooks","env","result","content","type","language","Array","isArray","classes","push","c","prism"],"mappings":"iKAEO,MAAMA,YAIZC,MAKAC,OAQAC,OAAS,GAOT,GAAAC,CAAKC,GACJC,KAAKL,MAAQI,CACf,CASC,GAAAE,CAAKC,GAEHF,KAAKJ,OADqB,mBAAhBM,EACIA,EAGAC,GAAaD,EAAYC,IAAcA,CAExD,CAQC,KAAAC,CAAOD,GACN,OAAOH,KAAKH,QAAUG,KAAKJ,OAASI,KAAKJ,OAAOO,GAAaA,EAC/D,EAIK,MAACE,EAAO,CACZC,GAAI,eACJC,OAAO,IACC,IAAIb,YAEZ,MAAAc,CAAQC,GAEP,MAAMC,EAAcD,EAAME,eAAeC,KAAKP,IAAOE,OAErD,OAAOE,EAAMI,MAAMf,IAAI,QAAQgB,IAC9B,GAAIJ,EAAmB,MAAG,CACzB,MAAMK,EAASL,EAAmB,MAAE,CACnCM,QAASF,EAAIE,QACbC,KAAMH,EAAIG,KACVC,SAAUJ,EAAII,WAGXC,MAAMC,QAAQL,GACjBD,EAAIO,QAAQC,QAAQP,GAEZA,GACRD,EAAIO,QAAQC,KAAKP,EAEtB,EAEQL,EAAoB,QAAMA,EAAYb,UAI3CiB,EAAIO,QAAUP,EAAIO,QAAQpB,KAAIsB,GAAKb,EAAYN,MAAMmB,KAAG,GAEzD,GAKFC,EAAMb,eAAeb,IAAIO"}