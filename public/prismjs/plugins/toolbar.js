import{p as t,g as e}from"../prism-DU08x7FD.js";import{n}from"../util-DdJteTVJ.js";import"../token-Dozwbq7Q.js";import"../insert-CpDsPTVw.js";import"../iterables-BnTatl6v.js";class Toolbar{callbacks=[];map=new Map;registerButton(t,e){let a;return a="function"==typeof e?e:function(t){const{text:n,url:a,onClick:r,className:o}=e;let s;return"function"==typeof r?(s=document.createElement("button"),s.type="button",s.addEventListener("click",(function(){r.call(this,t)}))):"string"==typeof a?(s=document.createElement("a"),s.href=a):s=document.createElement("span"),o&&s.classList.add(o),s.textContent=n,s},this.map.has(t)?(console.warn('There is a button with the key "'+t+'" registered already.'),n):(this.map.set(t,a),this.callbacks.push(a),()=>{this.map.delete(t);const e=this.callbacks.indexOf(a);-1!==e&&this.callbacks.splice(e,1)})}hook=t=>{const a=e(t.element);if(!a)return;const r=a.parentElement;if(!r)return;if(r.classList.contains("code-toolbar"))return;const o=document.createElement("div");o.classList.add("code-toolbar"),r.insertBefore(o,a),o.appendChild(a);const s=document.createElement("div");s.classList.add("toolbar");let l=this.callbacks;const c=(t=>{let e=t;for(;e;e=e.parentElement){let t=e.getAttribute("data-toolbar-order");if(null!=t)return t=t.trim(),t.length?t.split(/\s*,\s*/):[]}})(t.element);c&&(l=c.map((t=>this.map.get(t)||n))),l.forEach((e=>{const n=e(t);if(!n)return;const a=document.createElement("div");a.classList.add("toolbar-item"),a.appendChild(n),s.appendChild(a)})),o.appendChild(s)}}const a=t=>{const n=e(t.element);if(!n)return;if(!n.hasAttribute("data-label"))return;let a,r;const o=n.getAttribute("data-label");try{o&&(r=document.querySelector("template#"+o))}catch{}if(r)a=r.content;else{const t=n.getAttribute("data-url");t?(a=document.createElement("a"),a.href=t):a=document.createElement("span"),a.textContent=o}return a},r={id:"toolbar",plugin(){const t=new Toolbar;return t.registerButton("label",a),t},effect(t){const e=t.pluginRegistry.peek(r)?.plugin;return t.hooks.add("complete",e.hook)}};t.pluginRegistry.add(r);export{Toolbar,r as default};
