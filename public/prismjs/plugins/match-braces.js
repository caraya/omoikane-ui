import{p as e,g as t,i as s}from"../prism-DU08x7FD.js";import"../util-DdJteTVJ.js";import"../token-Dozwbq7Q.js";import"../insert-CpDsPTVw.js";import"../iterables-BnTatl6v.js";const c={id:"match-braces",effect(e){function c(t){const s=e.pluginRegistry.peek("custom-class")?.plugin;return s?s.apply(t):t}const n={"(":")","[":"]","{":"}"},o={"(":"brace-round","[":"brace-square","{":"brace-curly"},r={"${":"{"};let a=0;const i=/^(pair-\d+-)(close|open)$/;function l(e){const t=i.exec(e.id);return t?document.querySelector("#"+t[1]+("open"===t[2]?"close":"open")):null}function d(){if(!s(this,"brace-hover",!0))return;const e=l(this);e&&[this,e].forEach((e=>{e.classList.add(c("brace-hover"))}))}function u(){const e=l(this);e&&[this,e].forEach((e=>{e.classList.remove(c("brace-hover"))}))}function p(){if(!s(this,"brace-select",!0))return;const e=l(this);e&&[this,e].forEach((e=>{e.classList.add(c("brace-selected"))}))}const h=new WeakSet;return e.hooks.add("complete",(e=>{const i=e.element,l=t(i);if(!l)return;const f=[];if(s(i,"match-braces")&&f.push("(","[","{"),0===f.length)return;h.has(l)||(h.add(l),l.addEventListener("mousedown",(()=>{const e=l.querySelector("code"),t=c("brace-selected");e?.querySelectorAll("."+t).forEach((e=>{e.classList.remove(t)}))})));const m=[...i.querySelectorAll("span."+c("token")+"."+c("punctuation"))],b=[];f.forEach((e=>{const t=n[e],s=c(o[e]),i=[],l=[];for(let n=0;n<m.length;n++){const o=m[n];if(0===o.childElementCount){let a=o.textContent||"";if(a=r[a]||a,a===e)b.push({index:n,open:!0,element:o}),o.classList.add(s),o.classList.add(c("brace-open")),l.push(n);else if(a===t){b.push({index:n,open:!1,element:o}),o.classList.add(s),o.classList.add(c("brace-close"));const e=l.pop();void 0!==e&&i.push([n,e])}}}i.forEach((e=>{const t=`pair-${a++}-`,s=m[e[0]],c=m[e[1]];s.id=t+"open",c.id=t+"close",[s,c].forEach((e=>{e.addEventListener("mouseenter",d),e.addEventListener("mouseleave",u),e.addEventListener("click",p)}))}))}));let L=0;b.sort(((e,t)=>e.index-t.index)),b.forEach((e=>{e.open?(e.element.classList.add(c("brace-level-"+(L%12+1))),L++):(L=Math.max(0,L-1),e.element.classList.add(c("brace-level-"+(L%12+1))))}))}))}};e.pluginRegistry.add(c);export{c as default};
