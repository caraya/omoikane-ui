import{p as e}from"../prism-DU08x7FD.js";import s from"../languages/css-extras.js";import{f as t}from"../iterables-BnTatl6v.js";import"../util-DdJteTVJ.js";import"../token-Dozwbq7Q.js";import"../insert-CpDsPTVw.js";import"../languages/css-selector.js";const i="token",a="active",n="flipped";class Previewer{type;supportedLanguages;updater;initializer;_elt=null;_token=null;constructor(e,s,t="*",i){this.type=e,this.supportedLanguages=t,this.updater=s,this.initializer=i}init(){this._elt||(this._elt=document.createElement("div"),this._elt.className="prism-previewer prism-previewer-"+this.type,document.body.appendChild(this._elt),this.initializer&&this.initializer.call(this))}isDisabled(e){const s=e.closest("[data-previewers]")?.getAttribute("data-previewers");return!(s||"").split(/\s+/).includes(this.type)}tryShow(e){if(e.classList.contains(i)&&this.isDisabled(e))return;const s=e.closest(`.${i}.${this.type}`);s&&s!==this._token&&(this._token=s,this.show())}mouseout=()=>{this._token?.removeEventListener("mouseout",this.mouseout,!1),this._token=null,this.hide()};show(){if(this.init(),this._token)if(this.updater.call(this._elt,this._token.textContent||"")){this._token.addEventListener("mouseout",this.mouseout,!1);const e=(()=>{const e=this._token.getBoundingClientRect();let s=e.left,t=e.top;const i=document.documentElement.getBoundingClientRect();return s-=i.left,t-=i.top,{top:t,right:innerWidth-s-e.width,bottom:innerHeight-t-e.height,left:s,width:e.width,height:e.height}})();this._elt.classList.add(a),e.top-this._elt.offsetHeight>0?(this._elt.classList.remove(n),this._elt.style.top=e.top+"px",this._elt.style.bottom=""):(this._elt.classList.add(n),this._elt.style.bottom=e.bottom+"px",this._elt.style.top=""),this._elt.style.left=e.left+Math.min(200,e.width/2)+"px"}else this.hide()}hide(){this._elt?.classList.remove(a)}}class PreviewerCollection{byLanguages=new Map;byType=new Map;add(e){t(e.supportedLanguages,(s=>{let t=this.byLanguages.get(s);void 0===t&&(t=[],this.byLanguages.set(s,t)),t.includes(e)||t.push(e)})),this.byType.set(e.type,e)}initEvents(e,s){const t=[];t.push(...this.byLanguages.get(s)??[]),t.push(...this.byLanguages.get("*")??[]),0!==t.length&&e.addEventListener("mouseover",(e=>{const s=e.target;s&&t.forEach((e=>{e.tryShow(s)}))}),!1)}}const r={languages:{}},l={gradient:{create(){const e={};return new Previewer("gradient",(function(s){const t=this.firstChild;return!!t&&(t.style.backgroundImage="",t.style.backgroundImage=(s=>{if(e[s])return e[s];const t=s.replace(/^(?:\b|\B-[a-z]{1,10}-)(?:repeating-)?(?:linear|radial)-gradient\(|\)$/g,"").split(/\s*,\s*/),i=s.match(/^(\b|\B-[a-z]{1,10}-)((?:repeating-)?(?:linear|radial)-gradient)/);if(!i)return e[s]="";const a=i[1],n=i[2];return n.includes("linear")?e[s]=((e,s,t)=>{let i="180deg";const a=t[0];return a&&/^(?:-?(?:\d+(?:\.\d+)?|\.\d+)(?:deg|rad)|bottom|left|right|to\b|top)/.test(a)&&(i=a,t.shift(),i.includes("to ")||(i.includes("top")?i=i.includes("left")?"to bottom right":i.includes("right")?"to bottom left":"to bottom":i.includes("bottom")?i=i.includes("left")?"to top right":i.includes("right")?"to top left":"to top":i.includes("left")?i="to right":i.includes("right")?i="to left":e&&(i.includes("deg")?i=90-parseFloat(i)+"deg":i.includes("rad")&&(i=Math.PI/2-parseFloat(i)+"rad")))),s+"("+i+","+t.join(",")+")"})(a,n,t):n.includes("radial")?e[s]=((e,s,t)=>{if(!t[0].includes("at")){let e="center",i="ellipse",a="farthest-corner";if(/\b(?:bottom|center|left|right|top)\b|^\d+/.test(t[0])&&(e=t.shift().replace(/\s*-?\d+(?:deg|rad)\s*/,"")),/\b(?:circle|closest|contain|cover|ellipse|farthest)\b/.test(t[0])){const e=t.shift().split(/\s+/);!e[0]||"circle"!==e[0]&&"ellipse"!==e[0]||(i=e.shift()),e[0]&&(a=e.shift()),"cover"===a?a="farthest-corner":"contain"===a&&(a="clothest-side")}return s+"("+i+" "+a+" at "+e+","+t.join(",")+")"}return s+"("+t.join(",")+")"})(0,n,t):e[s]=n+"("+t.join(",")+")"})(s),!!t.style.backgroundImage)}),"*",(function(){this._elt.innerHTML="<div></div>"}))},tokens:{gradient:{pattern:/(?:\b|\B-[a-z]{1,10}-)(?:repeating-)?(?:linear|radial)-gradient\((?:(?:hsl|rgb)a?\(.+?\)|[^\)])+\)/gi,inside:{function:/[\w-]+(?=\()/,punctuation:/[(),]/}}},languages:{css:!0,less:!0,sass:[{lang:"sass",before:"punctuation",inside:"inside",root:r.languages.sass&&r.languages.sass["variable-line"]},{lang:"sass",before:"punctuation",inside:"inside",root:r.languages.sass&&r.languages.sass["property-line"]}],scss:!0,stylus:[{lang:"stylus",before:"func",inside:"rest",root:r.languages.stylus&&r.languages.stylus["property-declaration"].inside},{lang:"stylus",before:"func",inside:"rest",root:r.languages.stylus&&r.languages.stylus["variable-declaration"].inside}]}},angle:{create:()=>new Previewer("angle",(function(e){const s=parseFloat(e),t=e.match(/[a-z]+$/i);let i=1;if(!s||!t)return!1;switch(t[0]){case"deg":i=360;break;case"grad":i=400;break;case"rad":i=2*Math.PI;break;case"turn":i=1}const a=100*s/i%100;this[(s<0?"set":"remove")+"Attribute"]("data-negative","");const n=this.querySelector("circle");return n&&(n.style.strokeDasharray=Math.abs(a)+",500"),!0}),"*",(function(){this._elt.innerHTML='<svg viewBox="0 0 64 64"><circle r="16" cy="32" cx="32"></circle></svg>'})),tokens:{angle:/(?:\b|\B-|(?=\B\.))(?:\d+(?:\.\d+)?|\.\d+)(?:deg|g?rad|turn)\b/i},languages:{css:!0,less:!0,markup:{lang:"markup",before:"punctuation",inside:"inside",root:r.languages.markup&&r.languages.markup.tag.inside["attr-value"]},sass:[{lang:"sass",inside:"inside",root:r.languages.sass&&r.languages.sass["property-line"]},{lang:"sass",before:"operator",inside:"inside",root:r.languages.sass&&r.languages.sass["variable-line"]}],scss:!0,stylus:[{lang:"stylus",before:"func",inside:"rest",root:r.languages.stylus&&r.languages.stylus["property-declaration"].inside},{lang:"stylus",before:"func",inside:"rest",root:r.languages.stylus&&r.languages.stylus["variable-declaration"].inside}]}},color:{create:()=>new Previewer("color",(function(e){return this.style.backgroundColor="",this.style.backgroundColor=e,!!this.style.backgroundColor})),tokens:{color:[r.languages.css?.hexcode].concat(r.languages.css?.color)},languages:{css:!1,less:!0,markup:{lang:"markup",before:"punctuation",inside:"inside",root:r.languages.markup&&r.languages.markup.tag.inside["attr-value"]},sass:[{lang:"sass",before:"punctuation",inside:"inside",root:r.languages.sass&&r.languages.sass["variable-line"]},{lang:"sass",inside:"inside",root:r.languages.sass&&r.languages.sass["property-line"]}],scss:!1,stylus:[{lang:"stylus",before:"hexcode",inside:"rest",root:r.languages.stylus&&r.languages.stylus["property-declaration"].inside},{lang:"stylus",before:"hexcode",inside:"rest",root:r.languages.stylus&&r.languages.stylus["variable-declaration"].inside}]}},easing:{create(){const e={linear:"0,0,1,1",ease:".25,.1,.25,1","ease-in":".42,0,1,1","ease-out":"0,0,.58,1","ease-in-out":".42,0,.58,1"};return new Previewer("easing",(function(s){const t=(s=e[s]||s).match(/-?(?:\d+(?:\.\d+)?|\.\d+)/g);if(t&&4===t.length){const e=t.map(Number).map(((e,s)=>100*(s%2?1-e:e))).map(String);this.querySelector("path")?.setAttribute("d","M0,100 C"+e[0]+","+e[1]+", "+e[2]+","+e[3]+", 100,0");const s=this.querySelectorAll("line");return s[0].setAttribute("x2",e[0]),s[0].setAttribute("y2",e[1]),s[1].setAttribute("x2",e[2]),s[1].setAttribute("y2",e[3]),!0}return!1}),"*",(function(){this._elt.innerHTML='<svg viewBox="-20 -20 140 140" width="100" height="100"><defs><marker id="prism-previewer-easing-marker" viewBox="0 0 4 4" refX="2" refY="2" markerUnits="strokeWidth"><circle cx="2" cy="2" r="1.5" /></marker></defs><path d="M0,100 C20,50, 40,30, 100,0" /><line x1="0" y1="100" x2="20" y2="50" marker-start="url(#prism-previewer-easing-marker)" marker-end="url(#prism-previewer-easing-marker)" /><line x1="100" y1="0" x2="40" y2="30" marker-start="url(#prism-previewer-easing-marker)" marker-end="url(#prism-previewer-easing-marker)" /></svg>'}))},tokens:{easing:{pattern:/\bcubic-bezier\((?:-?(?:\d+(?:\.\d+)?|\.\d+),\s*){3}-?(?:\d+(?:\.\d+)?|\.\d+)\)\B|\b(?:ease(?:-in)?(?:-out)?|linear)(?=\s|[;}]|$)/i,inside:{function:/[\w-]+(?=\()/,punctuation:/[(),]/}}},languages:{css:!0,less:!0,sass:[{lang:"sass",inside:"inside",before:"punctuation",root:r.languages.sass&&r.languages.sass["variable-line"]},{lang:"sass",inside:"inside",root:r.languages.sass&&r.languages.sass["property-line"]}],scss:!0,stylus:[{lang:"stylus",before:"hexcode",inside:"rest",root:r.languages.stylus&&r.languages.stylus["property-declaration"].inside},{lang:"stylus",before:"hexcode",inside:"rest",root:r.languages.stylus&&r.languages.stylus["variable-declaration"].inside}]}},time:{create:()=>new Previewer("time",(function(e){const s=parseFloat(e),t=e.match(/[a-z]+$/i);if(!s||!t)return!1;const i=t[0],a=this.querySelector("circle");return a&&(a.style.animationDuration=`${2*s}${i}`),!0}),"*",(function(){this._elt.innerHTML='<svg viewBox="0 0 64 64"><circle r="16" cy="32" cx="32"></circle></svg>'})),tokens:{time:/(?:\b|\B-|(?=\B\.))(?:\d+(?:\.\d+)?|\.\d+)m?s\b/i},languages:{css:!0,less:!0,markup:{lang:"markup",before:"punctuation",inside:"inside",root:r.languages.markup&&r.languages.markup.tag.inside["attr-value"]},sass:[{lang:"sass",inside:"inside",root:r.languages.sass&&r.languages.sass["property-line"]},{lang:"sass",before:"operator",inside:"inside",root:r.languages.sass&&r.languages.sass["variable-line"]}],scss:!0,stylus:[{lang:"stylus",before:"hexcode",inside:"rest",root:r.languages.stylus&&r.languages.stylus["property-declaration"].inside},{lang:"stylus",before:"hexcode",inside:"rest",root:r.languages.stylus&&r.languages.stylus["variable-declaration"].inside}]}}},o={id:"previewers",require:s,plugin(){const e=new PreviewerCollection;if("undefined"!=typeof document)for(const s of Object.values(l))e.add(s.create());return e},effect:e=>e.hooks.add("after-highlight",(s=>{const t=e.pluginRegistry.peek(o)?.plugin;t.initEvents(s.element,s.language)}))};e.pluginRegistry.add(o);export{PreviewerCollection,o as default};
