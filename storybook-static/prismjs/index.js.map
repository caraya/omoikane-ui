{"version":3,"file":"index.js","sources":["../src/shared/meta/all-languages-data.js","../src/load-languages.js"],"sourcesContent":["/**\n * A list of the ids of all known languages.\n *\n * Note: This list is automatically generated by the build process.\n *\n * @type {string[]}\n */\nexport const knownLanguages = /* all_languages_placeholder[ */ []; /* ] */\n","import { resolveAlias } from './shared/meta/alias-data.js';\nimport { knownLanguages } from './shared/meta/all-languages-data.js';\nimport { toArray } from './util/iterables.js';\n\n/**\n * @param {string} dir\n * @param {string} file\n * @returns {string}\n */\nfunction pathJoin (dir, file) {\n\treturn dir.replace(/\\/$/, '') + '/' + file;\n}\n\n/** @type {Map<string, Promise>} */\nconst importCache = new Map();\n\n/**\n * @template T\n * @param {string} file\n * @returns {Promise<T>}\n */\nfunction importFile (file) {\n\tlet promise = importCache.get(file);\n\tif (promise === undefined) {\n\t\tpromise = import(file);\n\t\timportCache.set(file, promise);\n\t}\n\treturn promise;\n}\n\n/**\n * Loads the given languages and adds them to the given Prism instance.\n *\n * If no languages are provided, __all__ Prism languages will be loaded.\n *\n * @param {Prism} Prism\n * @param {string | string[]} [languages] Defaults to all known languages.\n * @param {string} [srcPath='.']\n * @returns {Promise}\n */\nexport async function loadLanguages (Prism, languages = knownLanguages, srcPath = '.') {\n\tlanguages = toArray(languages)\n\t\t.map(resolveAlias)\n\t\t.filter(id => !Prism.languageRegistry.has(id));\n\n\tawait Promise.all(\n\t\tlanguages.map(async id => {\n\t\t\ttry {\n\t\t\t\tconst path = pathJoin(srcPath, `languages/${id}.js`);\n\t\t\t\t/** @type {{ default: ComponentProto }} */\n\t\t\t\tconst exports = await importFile(path);\n\t\t\t\t// @ts-ignore\n\t\t\t\tPrism.languageRegistry.add(exports.default);\n\t\t\t}\n\t\t\tcatch (error) {\n\t\t\t\tif (!loadLanguages.silent) {\n\t\t\t\t\tconsole.warn(`Unable to load language ${id}: ${String(error)}`);\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t);\n}\n\n/**\n * Set this to `true` to prevent all warning messages `loadLanguages` logs.\n */\nloadLanguages.silent = false;\n\n/**\n * @import { Prism } from './core.js';\n * @import { ComponentProto } from './types.d.ts';\n */\n"],"names":["knownLanguages","importCache","Map","async","loadLanguages","Prism","languages","srcPath","toArray","map","resolveAlias","filter","id","languageRegistry","has","Promise","all","path","file","replace","exports","promise","get","undefined","import","set","importFile","add","default","error","silent","console","warn","String"],"mappings":"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"}