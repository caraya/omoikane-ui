import{p as t,g as e}from"../prism-DU08x7FD.js";import{h as n}from"../util-DdJteTVJ.js";import"../token-Dozwbq7Q.js";import"../insert-CpDsPTVw.js";import"../iterables-BnTatl6v.js";const s=/(?:^|\s)command-line(?:\s|$)/,o="command-line-prompt",a={id:"command-line",effect:t=>t.hooks.add({"before-highlight":t=>{const n=t.commandLine??={};if(n.complete||!t.code)return void(n.complete=!0);const a=e(t.element);if(!a||!s.test(a.className)&&!s.test(t.element.className))return void(n.complete=!0);const i=t.element.querySelector("."+o);i&&i.remove();const r=t.code.split("\n");n.numberOfLines=r.length;const l=n.outputLines=[],c=a.getAttribute("data-output"),m=a.getAttribute("data-filter-output");if(null!==c)c.split(",").forEach((t=>{const e=t.split("-");let n=parseInt(e[0],10),s=2===e.length?parseInt(e[1],10):n;if(!isNaN(n)&&!isNaN(s)){n<1&&(n=1),s>r.length&&(s=r.length),n--,s--;for(let t=n;t<=s;t++)l[t]=r[t],r[t]=""}}));else if(m)for(let t=0;t<r.length;t++)r[t].startsWith(m)&&(l[t]=r[t].slice(m.length),r[t]="");const p=n.continuationLineIndicies=new Set,d=a.getAttribute("data-continuation-str"),u=a.getAttribute("data-filter-continuation");for(let t=0;t<r.length;t++){const e=r[t];e&&(d&&e.endsWith(d)&&p.add(t+1),t>0&&u&&e.startsWith(u)&&(r[t]=e.slice(u.length),p.add(t)))}t.code=r.join("\n")},"before-insert":t=>{const e=t.commandLine??={};if(e.complete)return;const s=t.highlightedCode.split("\n"),o=e.outputLines||[];for(let t=0,e=s.length;t<e;t++)o.hasOwnProperty(t)?s[t]='<span class="token output">'+n(o[t])+"</span>":s[t]='<span class="token command">'+s[t]+"</span>";t.highlightedCode=s.join("\n")},complete:t=>{const n=t.commandLine??={};if(n.complete)return;const a=e(t.element);if(!a)return;s.test(t.element.className)&&(t.element.className=t.element.className.replace(s," ")),s.test(a.className)||(a.className+=" command-line");const i=(t,e)=>(a.getAttribute(t)||e).replace(/"/g,"&quot");let r="";const l=n.numberOfLines||0,c=i("data-prompt","");let m;m=""!==c?'<span data-prompt="'+c+'"></span>':'<span data-user="'+i("data-user","user")+'" data-host="'+i("data-host","localhost")+'"></span>';const p=n.continuationLineIndicies||new Set,d='<span data-continuation-prompt="'+i("data-continuation-prompt",">")+'"></span>';for(let t=0;t<l;t++)p.has(t)?r+=d:r+=m;const u=document.createElement("span");u.className=o,u.innerHTML=r;const h=n.outputLines||[];for(let t=0,e=h.length;t<e;t++)if(h.hasOwnProperty(t)){const e=u.children[t];e.removeAttribute("data-user"),e.removeAttribute("data-host"),e.removeAttribute("data-prompt")}t.element.insertBefore(u,t.element.firstChild),n.complete=!0}})};t.pluginRegistry.add(a);export{a as default};
