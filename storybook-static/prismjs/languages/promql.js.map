{"version":3,"file":"promql.js","sources":["../../src/languages/promql.js"],"sourcesContent":["/** @type {import('../types.d.ts').LanguageProto<'promql'>} */\nexport default {\n\tid: 'promql',\n\tgrammar () {\n\t\t// Thanks to: https://github.com/prometheus-community/monaco-promql/blob/master/src/promql/promql.ts\n\t\t// As well as: https://kausal.co/blog/slate-prism-add-new-syntax-promql/\n\n\t\t// PromQL Aggregation Operators\n\t\t// (https://prometheus.io/docs/prometheus/latest/querying/operators/#aggregation-operators)\n\t\tconst aggregations = [\n\t\t\t'sum',\n\t\t\t'min',\n\t\t\t'max',\n\t\t\t'avg',\n\t\t\t'group',\n\t\t\t'stddev',\n\t\t\t'stdvar',\n\t\t\t'count',\n\t\t\t'count_values',\n\t\t\t'bottomk',\n\t\t\t'topk',\n\t\t\t'quantile',\n\t\t];\n\n\t\t// PromQL vector matching + the by and without clauses\n\t\t// (https://prometheus.io/docs/prometheus/latest/querying/operators/#vector-matching)\n\t\tconst vectorMatching = ['on', 'ignoring', 'group_right', 'group_left', 'by', 'without'];\n\n\t\t// PromQL offset modifier\n\t\t// (https://prometheus.io/docs/prometheus/latest/querying/basics/#offset-modifier)\n\t\tconst offsetModifier = ['offset'];\n\n\t\tconst keywords = aggregations.concat(vectorMatching, offsetModifier);\n\n\t\treturn {\n\t\t\t'comment': {\n\t\t\t\tpattern: /(^[ \\t]*)#.*/m,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'vector-match': {\n\t\t\t\t// Match the comma-separated label lists inside vector matching:\n\t\t\t\tpattern: new RegExp('((?:' + vectorMatching.join('|') + ')\\\\s*)\\\\([^)]*\\\\)'),\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'label-key': {\n\t\t\t\t\t\tpattern: /\\b[^,]+\\b/,\n\t\t\t\t\t\talias: 'attr-name',\n\t\t\t\t\t},\n\t\t\t\t\t'punctuation': /[(),]/,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'context-labels': {\n\t\t\t\tpattern: /\\{[^{}]*\\}/,\n\t\t\t\tinside: {\n\t\t\t\t\t'label-key': {\n\t\t\t\t\t\tpattern: /\\b[a-z_]\\w*(?=\\s*(?:=|![=~]))/,\n\t\t\t\t\t\talias: 'attr-name',\n\t\t\t\t\t},\n\t\t\t\t\t'label-value': {\n\t\t\t\t\t\tpattern: /([\"'`])(?:\\\\[\\s\\S]|(?!\\1)[^\\\\])*\\1/,\n\t\t\t\t\t\tgreedy: true,\n\t\t\t\t\t\talias: 'attr-value',\n\t\t\t\t\t},\n\t\t\t\t\t'punctuation': /\\{|\\}|=~?|![=~]|,/,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'context-range': [\n\t\t\t\t{\n\t\t\t\t\tpattern: /\\[[\\w\\s:]+\\]/, // [1m]\n\t\t\t\t\tinside: {\n\t\t\t\t\t\t'punctuation': /\\[|\\]|:/,\n\t\t\t\t\t\t'range-duration': {\n\t\t\t\t\t\t\tpattern: /\\b(?:\\d+(?:[smhdwy]|ms))+\\b/i,\n\t\t\t\t\t\t\talias: 'number',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpattern: /(\\boffset\\s+)\\w+/, // offset 1m\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\tinside: {\n\t\t\t\t\t\t'range-duration': {\n\t\t\t\t\t\t\tpattern: /\\b(?:\\d+(?:[smhdwy]|ms))+\\b/i,\n\t\t\t\t\t\t\talias: 'number',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\t'keyword': new RegExp('\\\\b(?:' + keywords.join('|') + ')\\\\b', 'i'),\n\t\t\t'function': /\\b[a-z_]\\w*(?=\\s*\\()/i,\n\t\t\t'number':\n\t\t\t\t/[-+]?(?:(?:\\b\\d+(?:\\.\\d+)?|\\B\\.\\d+)(?:e[-+]?\\d+)?\\b|\\b(?:0x[0-9a-f]+|nan|inf)\\b)/i,\n\t\t\t'operator': /[\\^*/%+-]|==|!=|<=|<|>=|>|\\b(?:and|or|unless)\\b/i,\n\t\t\t'punctuation': /[{};()`,.[\\]]/,\n\t\t};\n\t},\n};\n"],"names":["promql","id","grammar","vectorMatching","keywords","concat","comment","pattern","lookbehind","RegExp","join","inside","alias","punctuation","greedy","keyword","function","number","operator"],"mappings":"AACA,IAAeA,EAAA,CACdC,GAAI,SACJ,OAAAC,GAMC,MAiBMC,EAAiB,CAAC,KAAM,WAAY,cAAe,aAAc,KAAM,WAMvEC,EAvBe,CACpB,MACA,MACA,MACA,MACA,QACA,SACA,SACA,QACA,eACA,UACA,OACA,YAW6BC,OAAOF,EAFd,CAAC,WAIxB,MAAO,CACNG,QAAW,CACVC,QAAS,gBACTC,YAAY,GAEb,eAAgB,CAEfD,QAAaE,OAAO,OAASN,EAAeO,KAAK,KAAO,qBACxDF,YAAY,EACZG,OAAQ,CACP,YAAa,CACZJ,QAAS,YACTK,MAAO,aAERC,YAAe,UAGjB,iBAAkB,CACjBN,QAAS,aACTI,OAAQ,CACP,YAAa,CACZJ,QAAS,gCACTK,MAAO,aAER,cAAe,CACdL,QAAS,qCACTO,QAAQ,EACRF,MAAO,cAERC,YAAe,sBAGjB,gBAAiB,CAChB,CACCN,QAAS,eACTI,OAAQ,CACPE,YAAe,UACf,iBAAkB,CACjBN,QAAS,+BACTK,MAAO,YAIV,CACCL,QAAS,mBACTC,YAAY,EACZG,OAAQ,CACP,iBAAkB,CACjBJ,QAAS,+BACTK,MAAO,aAKXG,QAAeN,OAAO,SAAWL,EAASM,KAAK,KAAO,OAAQ,KAC9DM,SAAY,wBACZC,OACC,oFACDC,SAAY,mDACZL,YAAe,gBAEhB"}