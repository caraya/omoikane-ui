{"version":3,"file":"asciidoc.js","sources":["../../src/languages/asciidoc.js"],"sourcesContent":["/** @type {import('../types.d.ts').LanguageProto<'asciidoc'>} */\nexport default {\n\tid: 'asciidoc',\n\talias: 'adoc',\n\tgrammar () {\n\t\tconst placeholder = /** @type {Grammar['inside']} */ null;\n\n\t\tconst attributes = {\n\t\t\tpattern:\n\t\t\t\t/(^[ \\t]*)\\[(?!\\[)(?:([\"'$`])(?:(?!\\2)[^\\\\]|\\\\.)*\\2|\\[(?:[^\\[\\]\\\\]|\\\\.)*\\]|[^\\[\\]\\\\\"'$`]|\\\\.)*\\]/m,\n\t\t\tlookbehind: true,\n\t\t\tinside: {\n\t\t\t\t'quoted': {\n\t\t\t\t\tpattern: /([$`])(?:(?!\\1)[^\\\\]|\\\\.)*\\1/,\n\t\t\t\t\tinside: {\n\t\t\t\t\t\t'punctuation': /^[$`]|[$`]$/,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t'interpreted': {\n\t\t\t\t\tpattern: /'(?:[^'\\\\]|\\\\.)*'/,\n\t\t\t\t\tinside: {\n\t\t\t\t\t\t'punctuation': /^'|'$/,\n\t\t\t\t\t\t$rest: /** @type {Grammar['$rest']} */ (placeholder),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t'string': /\"(?:[^\"\\\\]|\\\\.)*\"/,\n\t\t\t\t'variable': /\\w+(?==)/,\n\t\t\t\t'punctuation': /^\\[|\\]$|,/,\n\t\t\t\t'operator': /=/,\n\t\t\t\t// The negative look-ahead prevents blank matches\n\t\t\t\t'attr-value': /(?!^\\s+$).+/,\n\t\t\t},\n\t\t};\n\n\t\tconst asciidoc = /** @type {Grammar} */ ({\n\t\t\t'comment-block': {\n\t\t\t\tpattern: /^(\\/{4,})$[\\s\\S]*?^\\1/m,\n\t\t\t\talias: 'comment',\n\t\t\t},\n\t\t\t'table': {\n\t\t\t\tpattern: /^\\|={3,}(?:(?:\\r?\\n|\\r(?!\\n)).*)*?(?:\\r?\\n|\\r)\\|={3,}$/m,\n\t\t\t\tinside: {\n\t\t\t\t\t'specifiers': {\n\t\t\t\t\t\tpattern:\n\t\t\t\t\t\t\t/(?:(?:(?:\\d+(?:\\.\\d+)?|\\.\\d+)[+*](?:[<^>](?:\\.[<^>])?|\\.[<^>])?|[<^>](?:\\.[<^>])?|\\.[<^>])[a-z]*|[a-z]+)(?=\\|)/,\n\t\t\t\t\t\talias: 'attr-value',\n\t\t\t\t\t},\n\t\t\t\t\t'punctuation': {\n\t\t\t\t\t\tpattern: /(^|[^\\\\])[|!]=*/,\n\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t},\n\t\t\t\t\t$rest: /** @type {Grammar['$rest']} */ (placeholder),\n\t\t\t\t},\n\t\t\t},\n\n\t\t\t'passthrough-block': {\n\t\t\t\tpattern: /^(\\+{4,})$[\\s\\S]*?^\\1$/m,\n\t\t\t\tinside: {\n\t\t\t\t\t'punctuation': /^\\++|\\++$/,\n\t\t\t\t\t$rest: /** @type {Grammar['$rest']} */ (placeholder),\n\t\t\t\t},\n\t\t\t},\n\t\t\t// Literal blocks and listing blocks\n\t\t\t'literal-block': {\n\t\t\t\tpattern: /^(-{4,}|\\.{4,})$[\\s\\S]*?^\\1$/m,\n\t\t\t\tinside: {\n\t\t\t\t\t'punctuation': /^(?:-+|\\.+)|(?:-+|\\.+)$/,\n\t\t\t\t\t$rest: /** @type {Grammar['$rest']} */ (placeholder),\n\t\t\t\t},\n\t\t\t},\n\t\t\t// Sidebar blocks, quote blocks, example blocks and open blocks\n\t\t\t'other-block': {\n\t\t\t\tpattern: /^(--|\\*{4,}|_{4,}|={4,})$[\\s\\S]*?^\\1$/m,\n\t\t\t\tinside: {\n\t\t\t\t\t'punctuation': /^(?:-+|\\*+|_+|=+)|(?:-+|\\*+|_+|=+)$/,\n\t\t\t\t\t$rest: /** @type {Grammar['$rest']} */ (placeholder),\n\t\t\t\t},\n\t\t\t},\n\n\t\t\t// list-punctuation and list-label must appear before indented-block\n\t\t\t'list-punctuation': {\n\t\t\t\tpattern: /(^[ \\t]*)(?:-|\\*{1,5}|\\.{1,5}|(?:[a-z]|\\d+)\\.|[xvi]+\\))(?= )/im,\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'punctuation',\n\t\t\t},\n\t\t\t'list-label': {\n\t\t\t\tpattern: /(^[ \\t]*)[a-z\\d].+(?::{2,4}|;;)(?=\\s)/im,\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'symbol',\n\t\t\t},\n\t\t\t'indented-block': {\n\t\t\t\tpattern: /((\\r?\\n|\\r)\\2)([ \\t]+)\\S.*(?:(?:\\r?\\n|\\r)\\3.+)*(?=\\2{2}|$)/,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\n\t\t\t'comment': /^\\/\\/.*/m,\n\t\t\t'title': {\n\t\t\t\tpattern:\n\t\t\t\t\t/^.+(?:\\r?\\n|\\r)(?:={3,}|-{3,}|~{3,}|\\^{3,}|\\+{3,})$|^={1,5} .+|^\\.(?![\\s.]).*/m,\n\t\t\t\talias: 'important',\n\t\t\t\tinside: {\n\t\t\t\t\t'punctuation': /^(?:\\.|=+)|(?:=+|-+|~+|\\^+|\\++)$/,\n\t\t\t\t\t$rest: /** @type {Grammar['$rest']} */ (placeholder),\n\t\t\t\t},\n\t\t\t},\n\t\t\t'attribute-entry': {\n\t\t\t\tpattern: /^:[^:\\r\\n]+:(?: .*?(?: \\+(?:\\r?\\n|\\r).*?)*)?$/m,\n\t\t\t\talias: 'tag',\n\t\t\t},\n\t\t\t'attributes': attributes,\n\t\t\t'hr': {\n\t\t\t\tpattern: /^'{3,}$/m,\n\t\t\t\talias: 'punctuation',\n\t\t\t},\n\t\t\t'page-break': {\n\t\t\t\tpattern: /^<{3,}$/m,\n\t\t\t\talias: 'punctuation',\n\t\t\t},\n\t\t\t'admonition': {\n\t\t\t\tpattern: /^(?:CAUTION|IMPORTANT|NOTE|TIP|WARNING):/m,\n\t\t\t\talias: 'keyword',\n\t\t\t},\n\t\t\t'callout': [\n\t\t\t\t{\n\t\t\t\t\tpattern: /(^[ \\t]*)<?\\d*>/m,\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\talias: 'symbol',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpattern: /<\\d+>/,\n\t\t\t\t\talias: 'symbol',\n\t\t\t\t},\n\t\t\t],\n\t\t\t'macro': {\n\t\t\t\tpattern:\n\t\t\t\t\t/\\b[a-z\\d][a-z\\d-]*::?(?:[^\\s\\[\\]]*\\[(?:[^\\]\\\\\"']|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*\\1|\\\\.)*\\])/,\n\t\t\t\tinside: {\n\t\t\t\t\t'function': /^[a-z\\d-]+(?=:)/,\n\t\t\t\t\t'punctuation': /^::?/,\n\t\t\t\t\t'attributes': {\n\t\t\t\t\t\tpattern: /(?:\\[(?:[^\\]\\\\\"']|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*\\1|\\\\.)*\\])/,\n\t\t\t\t\t\tinside: attributes.inside,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\t'inline': {\n\t\t\t\t/*\n\t\t\t\t\tThe initial look-behind prevents the highlighting of escaped quoted text.\n\n\t\t\t\t\tQuoted text can be multi-line but cannot span an empty line.\n\t\t\t\t\tAll quoted text can have attributes before [foobar, 'foobar', baz=\"bar\"].\n\n\t\t\t\t\tFirst, we handle the constrained quotes.\n\t\t\t\t\tThose must be bounded by non-word chars and cannot have spaces between the delimiter and the first char.\n\t\t\t\t\tThey are, in order: _emphasis_, ``double quotes'', `single quotes', `monospace`, 'emphasis', *strong*, +monospace+ and #unquoted#\n\n\t\t\t\t\tThen we handle the unconstrained quotes.\n\t\t\t\t\tThose do not have the restrictions of the constrained quotes.\n\t\t\t\t\tThey are, in order: __emphasis__, **strong**, ++monospace++, +++passthrough+++, ##unquoted##, $$passthrough$$, ~subscript~, ^superscript^, {attribute-reference}, [[anchor]], [[[bibliography anchor]]], <<xref>>, (((indexes))) and ((indexes))\n\t\t\t\t\t */\n\t\t\t\tpattern:\n\t\t\t\t\t/(^|[^\\\\])(?:(?:\\B\\[(?:[^\\]\\\\\"']|([\"'])(?:(?!\\2)[^\\\\]|\\\\.)*\\2|\\\\.)*\\])?(?:\\b_(?!\\s)(?: _|[^_\\\\\\r\\n]|\\\\.)+(?:(?:\\r?\\n|\\r)(?: _|[^_\\\\\\r\\n]|\\\\.)+)*_\\b|\\B``(?!\\s).+?(?:(?:\\r?\\n|\\r).+?)*''\\B|\\B`(?!\\s)(?:[^`'\\s]|\\s+\\S)+['`]\\B|\\B(['*+#])(?!\\s)(?: \\3|(?!\\3)[^\\\\\\r\\n]|\\\\.)+(?:(?:\\r?\\n|\\r)(?: \\3|(?!\\3)[^\\\\\\r\\n]|\\\\.)+)*\\3\\B)|(?:\\[(?:[^\\]\\\\\"']|([\"'])(?:(?!\\4)[^\\\\]|\\\\.)*\\4|\\\\.)*\\])?(?:(__|\\*\\*|\\+\\+\\+?|##|\\$\\$|[~^]).+?(?:(?:\\r?\\n|\\r).+?)*\\5|\\{[^}\\r\\n]+\\}|\\[\\[\\[?.+?(?:(?:\\r?\\n|\\r).+?)*\\]?\\]\\]|<<.+?(?:(?:\\r?\\n|\\r).+?)*>>|\\(\\(\\(?.+?(?:(?:\\r?\\n|\\r).+?)*\\)?\\)\\)))/m,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'attributes': attributes,\n\t\t\t\t\t'url': {\n\t\t\t\t\t\tpattern: /^(?:\\[\\[\\[?.+?\\]?\\]\\]|<<.+?>>)$/,\n\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\t'punctuation': /^(?:\\[\\[\\[?|<<)|(?:\\]\\]\\]?|>>)$/,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t'attribute-ref': {\n\t\t\t\t\t\tpattern: /^\\{.+\\}$/,\n\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\t'variable': {\n\t\t\t\t\t\t\t\tpattern: /(^\\{)[a-z\\d,+_-]+/,\n\t\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'operator': /^[=?!#%@$]|!(?=[:}])/,\n\t\t\t\t\t\t\t'punctuation': /^\\{|\\}$|::?/,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t'italic': {\n\t\t\t\t\t\tpattern: /^(['_])[\\s\\S]+\\1$/,\n\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\t'punctuation': /^(?:''?|__?)|(?:''?|__?)$/,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t'bold': {\n\t\t\t\t\t\tpattern: /^\\*[\\s\\S]+\\*$/,\n\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\tpunctuation: /^\\*\\*?|\\*\\*?$/,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t'punctuation':\n\t\t\t\t\t\t/^(?:``?|\\+{1,3}|##?|\\$\\$|[~^]|\\(\\(\\(?)|(?:''?|\\+{1,3}|##?|\\$\\$|[~^`]|\\)?\\)\\))$/,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'replacement': {\n\t\t\t\tpattern: /\\((?:C|R|TM)\\)/,\n\t\t\t\talias: 'builtin',\n\t\t\t},\n\t\t\t'entity': /&#?[\\da-z]{1,8};/i,\n\t\t\t'line-continuation': {\n\t\t\t\tpattern: /(^| )\\+$/m,\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'punctuation',\n\t\t\t},\n\t\t});\n\n\t\t// Allow some nesting. There is no recursion though, so cloning should not be needed.\n\n\t\t/**\n\t\t * @param {string[]} keys\n\t\t */\n\t\tfunction copyFromAsciiDoc (...keys) {\n\t\t\tconst o = /** @type {Grammar} */ ({});\n\t\t\tfor (const key of keys) {\n\t\t\t\to[key] = asciidoc[key];\n\t\t\t}\n\t\t\treturn o;\n\t\t}\n\n\t\tattributes.inside['interpreted'].inside.$rest = copyFromAsciiDoc(\n\t\t\t'macro',\n\t\t\t'inline',\n\t\t\t'replacement',\n\t\t\t'entity'\n\t\t);\n\n\t\t/** @type {GrammarToken & { inside: Grammar }} */ (\n\t\t\tasciidoc['passthrough-block']\n\t\t).inside.$rest = copyFromAsciiDoc('macro');\n\n\t\t/** @type {GrammarToken & { inside: Grammar }} */ (asciidoc['literal-block']).inside.$rest =\n\t\t\tcopyFromAsciiDoc('callout');\n\n\t\t/** @type {GrammarToken & { inside: Grammar }} */ (asciidoc['table']).inside.$rest =\n\t\t\tcopyFromAsciiDoc(\n\t\t\t\t'comment-block',\n\t\t\t\t'passthrough-block',\n\t\t\t\t'literal-block',\n\t\t\t\t'other-block',\n\t\t\t\t'list-punctuation',\n\t\t\t\t'indented-block',\n\t\t\t\t'comment',\n\t\t\t\t'title',\n\t\t\t\t'attribute-entry',\n\t\t\t\t'attributes',\n\t\t\t\t'hr',\n\t\t\t\t'page-break',\n\t\t\t\t'admonition',\n\t\t\t\t'list-label',\n\t\t\t\t'callout',\n\t\t\t\t'macro',\n\t\t\t\t'inline',\n\t\t\t\t'replacement',\n\t\t\t\t'entity',\n\t\t\t\t'line-continuation'\n\t\t\t);\n\n\t\t/** @type {GrammarToken & { inside: Grammar }} */ (asciidoc['other-block']).inside.$rest =\n\t\t\tcopyFromAsciiDoc(\n\t\t\t\t'table',\n\t\t\t\t'list-punctuation',\n\t\t\t\t'indented-block',\n\t\t\t\t'comment',\n\t\t\t\t'attribute-entry',\n\t\t\t\t'attributes',\n\t\t\t\t'hr',\n\t\t\t\t'page-break',\n\t\t\t\t'admonition',\n\t\t\t\t'list-label',\n\t\t\t\t'macro',\n\t\t\t\t'inline',\n\t\t\t\t'replacement',\n\t\t\t\t'entity',\n\t\t\t\t'line-continuation'\n\t\t\t);\n\n\t\t/** @type {GrammarToken & { inside: Grammar }} */ (asciidoc['title']).inside.$rest =\n\t\t\tcopyFromAsciiDoc('macro', 'inline', 'replacement', 'entity');\n\n\t\treturn asciidoc;\n\t},\n\teffect (Prism) {\n\t\t// Plugin to make entity title show the real entity, idea by Roman Komarov\n\t\treturn Prism.hooks.add('wrap', env => {\n\t\t\tif (env.type === 'entity') {\n\t\t\t\tenv.attributes['title'] = env.content.replace(/&amp;/, '&');\n\t\t\t}\n\t\t});\n\t},\n};\n\n/**\n * @typedef {import('../types.d.ts').Grammar} Grammar\n * @typedef {import('../types.d.ts').GrammarToken} GrammarToken\n */\n"],"names":["asciidoc","id","alias","grammar","placeholder","attributes","pattern","lookbehind","inside","quoted","punctuation","interpreted","$rest","string","variable","operator","table","specifiers","comment","title","hr","admonition","callout","macro","function","inline","url","italic","bold","replacement","entity","copyFromAsciiDoc","keys","o","key","effect","Prism","hooks","add","env","type","content","replace"],"mappings":"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"}