import{T as t,g as e}from"../token-Dozwbq7Q.js";import{i as n}from"../insert-CpDsPTVw.js";import{w as s}from"../without-tokenize-Bwi0ec2C.js";import o from"./javascript.js";import i from"./markup.js";import"../iterables-BnTatl6v.js";import"../patterns-A_vPglum.js";import"./clike.js";import"./xml.js";function a(t){return t?e(t):""}function r(e){const n=[];for(let s=0;s<e.length;s++){const o=e[s],i="string"!=typeof o;let p=!1;if(i){const t=o.content[1];if("tag"===o.type&&"object"==typeof t&&"tag"===t.type){const e=o.content[0];if("object"==typeof e&&"</"===e.content)n.length>0&&n[n.length-1].tagName===a(t)&&n.pop();else{const e=o.content[o.content.length-1];"object"==typeof e&&"/>"===e.content||n.push({tagName:a(t),openedBraces:0})}}else n.length>0&&"punctuation"===o.type&&"{"===o.content?n[n.length-1].openedBraces++:n.length>0&&n[n.length-1].openedBraces>0&&"punctuation"===o.type&&"}"===o.content?n[n.length-1].openedBraces--:p=!0}if((p||!i)&&n.length>0&&0===n[n.length-1].openedBraces){let n=a(o);const i=e[s+1];!i||"string"!=typeof i&&"plain-text"!==i.type||(n+=a(i),e.splice(s+1,1));const r=e[s-1];!r||"string"!=typeof r&&"plain-text"!==r.type||(n=a(r)+n,e.splice(s-1,1),s--),e[s]=new t("plain-text",n,void 0,n)}i&&"string"!=typeof o.content&&r(o.content)}}var p={id:"jsx",require:[i,o],grammar({extend:t}){let e="(?:\\{<S>*\\.{3}(?:[^{}]|<BRACES>)*\\})";function o(t,n){return t=t.replace(/<S>/g,(()=>"(?:\\s|//.*(?!.)|/\\*(?:[^*]|\\*(?!/))\\*/)")).replace(/<BRACES>/g,(()=>"(?:\\{(?:\\{(?:\\{[^{}]*\\}|[^{}])*\\}|[^{}])*\\})")).replace(/<SPREAD>/g,(()=>e)),RegExp(t,n)}e=o(e).source;const i=t("javascript",{}),a=t("markup",i),p=a.tag;return p.pattern=o("</?(?:[\\w.:-]+(?:<S>+(?:[\\w.:$-]+(?:=(?:\"(?:\\\\[^]|[^\\\\\"])*\"|'(?:\\\\[^]|[^\\\\'])*'|[^\\s{'\"/>=]+|<BRACES>))?|<SPREAD>))*<S>*/?)?>"),p.inside.tag.pattern=/^(<\/?)[^\s>\/]*/,p.inside["attr-value"].pattern=/=(?!\{)(?:"(?:\\[\s\S]|[^\\"])*"|'(?:\\[\s\S]|[^\\'])*'|[^\s'">]+)/,p.inside.tag.inside["class-name"]=/^[A-Z]\w*(?:\.[A-Z]\w*)*$/,p.inside.comment=i.comment,n(p.inside,"attr-name",{spread:{pattern:o("<SPREAD>"),inside:"jsx"}}),n(p.inside,"special-attr",{script:{pattern:o("=<BRACES>"),alias:"language-javascript",inside:{"script-punctuation":{pattern:/^=(?=\{)/,alias:"punctuation"},$rest:"jsx"}}}),a.$tokenize=(t,e,n)=>{const o=n.tokenize(t,s(e));return r(o),o},a}};export{p as default};
