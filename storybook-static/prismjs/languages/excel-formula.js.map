{"version":3,"file":"excel-formula.js","sources":["../../src/languages/excel-formula.js"],"sourcesContent":["/** @type {import('../types.d.ts').LanguageProto<'excel-formula'>} */\nexport default {\n\tid: 'excel-formula',\n\talias: ['xlsx', 'xls'],\n\tgrammar: {\n\t\t'comment': {\n\t\t\tpattern: /(\\bN\\(\\s*)\"(?:[^\"]|\"\")*\"(?=\\s*\\))/i,\n\t\t\tlookbehind: true,\n\t\t\tgreedy: true,\n\t\t},\n\t\t'string': {\n\t\t\tpattern: /\"(?:[^\"]|\"\")*\"(?!\")/,\n\t\t\tgreedy: true,\n\t\t},\n\t\t'reference': {\n\t\t\t// https://www.ablebits.com/office-addins-blog/2015/12/08/excel-reference-another-sheet-workbook/\n\n\t\t\t// Sales!B2\n\t\t\t// 'Winter sales'!B2\n\t\t\t// [Sales.xlsx]Jan!B2:B5\n\t\t\t// D:\\Reports\\[Sales.xlsx]Jan!B2:B5\n\t\t\t// '[Sales.xlsx]Jan sales'!B2:B5\n\t\t\t// 'D:\\Reports\\[Sales.xlsx]Jan sales'!B2:B5\n\n\t\t\tpattern: /(?:'[^']*'|(?:[^\\s()[\\]{}<>*?\"';,$&]*\\[[^^\\s()[\\]{}<>*?\"']+\\])?\\w+)!/,\n\t\t\tgreedy: true,\n\t\t\talias: 'string',\n\t\t\tinside: {\n\t\t\t\t'operator': /!$/,\n\t\t\t\t'punctuation': /'/,\n\t\t\t\t'sheet': {\n\t\t\t\t\tpattern: /[^[\\]]+$/,\n\t\t\t\t\talias: 'function',\n\t\t\t\t},\n\t\t\t\t'file': {\n\t\t\t\t\tpattern: /\\[[^[\\]]+\\]$/,\n\t\t\t\t\tinside: {\n\t\t\t\t\t\t'punctuation': /[[\\]]/,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t'path': /[\\s\\S]+/,\n\t\t\t},\n\t\t},\n\t\t'function-name': {\n\t\t\tpattern: /\\b[A-Z]\\w*(?=\\()/i,\n\t\t\talias: 'builtin',\n\t\t},\n\t\t'range': {\n\t\t\tpattern: /\\$?\\b(?:[A-Z]+\\$?\\d+:\\$?[A-Z]+\\$?\\d+|[A-Z]+:\\$?[A-Z]+|\\d+:\\$?\\d+)\\b/i,\n\t\t\talias: 'selector',\n\t\t\tinside: {\n\t\t\t\t'operator': /:/,\n\t\t\t\t'cell': /\\$?[A-Z]+\\$?\\d+/i,\n\t\t\t\t'column': /\\$?[A-Z]+/i,\n\t\t\t\t'row': /\\$?\\d+/,\n\t\t\t},\n\t\t},\n\t\t'cell': {\n\t\t\t// Excel is case insensitive, so the string \"foo1\" could be either a variable or a cell.\n\t\t\t// To combat this, we match cells case insensitive, if the contain at least one \"$\", and case sensitive otherwise.\n\t\t\tpattern: /\\b[A-Z]+\\d+\\b|\\$[A-Za-z]+\\$?\\d+\\b|\\b[A-Za-z]+\\$\\d+\\b/,\n\t\t\talias: 'selector',\n\t\t},\n\t\t'number': /(?:\\b\\d+(?:\\.\\d+)?|\\B\\.\\d+)(?:e[+-]?\\d+)?\\b/i,\n\t\t'boolean': /\\b(?:FALSE|TRUE)\\b/i,\n\t\t'operator': /[-+*/^%=&,]|<[=>]?|>=?/,\n\t\t'punctuation': /[[\\]();{}|]/,\n\t},\n};\n"],"names":["excelFormula","id","alias","grammar","comment","pattern","lookbehind","greedy","string","reference","inside","operator","punctuation","sheet","file","path","range","cell","column","row","number","boolean"],"mappings":"AACA,IAAeA,EAAA,CACdC,GAAI,gBACJC,MAAO,CAAC,OAAQ,OACjBC,QAAA,KAAA,CAAAC,QAAA,CAAAC,QAAA,qCAAAC,YAAA,EAAAC,QAAA,GAAAC,OAAA,CAAAH,QAAA,sBAAAE,QAAA,GAAAE,UAAA,CAAAJ,QAAA,uEAAAE,QAAA,EAAAL,MAAA,SAAAQ,OAAA,CAAAC,SAAA,KAAAC,YAAA,IAAAC,MAAA,CAAAR,QAAA,WAAAH,MAAA,YAAAY,KAAA,CAAAT,QAAA,eAAAK,OAAA,CAAAE,YAAA,UAAAG,KAAA,YAAA,gBAAA,CAAAV,QAAA,oBAAAH,MAAA,WAAAc,MAAA,CAAAX,QAAA,uEAAAH,MAAA,WAAAQ,OAAA,CAAAC,SAAA,IAAAM,KAAA,mBAAAC,OAAA,aAAAC,IAAA,WAAAF,KAAA,CAAAZ,QAAA,uDAAAH,MAAA,YAAAkB,OAAA,+CAAAC,QAAA,sBAAAV,SAAA,yBAAAC,YAAA"}