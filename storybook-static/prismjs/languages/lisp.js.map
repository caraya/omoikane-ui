{"version":3,"file":"lisp.js","sources":["../../src/languages/lisp.js"],"sourcesContent":["/** @type {import('../types.d.ts').LanguageProto<'lisp'>} */\nexport default {\n\tid: 'lisp',\n\talias: ['emacs', 'elisp', 'emacs-lisp'],\n\tgrammar () {\n\t\t/**\n\t\t * Functions to construct regular expressions\n\t\t * e.g. (interactive ... or (interactive)\n\t\t *\n\t\t * @param {string} name\n\t\t * @returns {RegExp}\n\t\t */\n\t\tfunction simple_form (name) {\n\t\t\treturn RegExp(/(\\()/.source + '(?:' + name + ')' + /(?=[\\s\\)])/.source);\n\t\t}\n\t\t/**\n\t\t * booleans and numbers\n\t\t *\n\t\t * @param {string} pattern\n\t\t * @returns {RegExp}\n\t\t */\n\t\tfunction primitive (pattern) {\n\t\t\treturn RegExp(/([\\s([])/.source + '(?:' + pattern + ')' + /(?=[\\s)])/.source);\n\t\t}\n\n\t\t// Patterns in regular expressions\n\n\t\t// Symbol name. See https://www.gnu.org/software/emacs/manual/html_node/elisp/Symbol-Type.html\n\t\t// & and : are excluded as they are usually used for special purposes\n\t\tconst symbol = /(?!\\d)[-+*/~!@$%^=<>{}\\w]+/.source;\n\t\t// symbol starting with & used in function arguments\n\t\tconst marker = '&' + symbol;\n\t\t// Open parenthesis for look-behind\n\t\tconst par = '(\\\\()';\n\t\tconst endpar = '(?=\\\\))';\n\t\t// End the pattern with look-ahead space\n\t\tconst space = '(?=\\\\s)';\n\t\tconst nestedPar =\n\t\t\t/(?:[^()]|\\((?:[^()]|\\((?:[^()]|\\((?:[^()]|\\((?:[^()]|\\([^()]*\\))*\\))*\\))*\\))*\\))*/\n\t\t\t\t.source;\n\n\t\tconst arg = {\n\t\t\t'lisp-marker': RegExp(marker),\n\t\t\t'varform': {\n\t\t\t\tpattern: RegExp(\n\t\t\t\t\t/\\(/.source + symbol + /\\s+(?=\\S)/.source + nestedPar + /\\)/.source\n\t\t\t\t),\n\t\t\t\tinside: 'lisp',\n\t\t\t},\n\t\t\t'argument': {\n\t\t\t\tpattern: RegExp(/(^|[\\s(])/.source + symbol),\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'variable',\n\t\t\t},\n\t\t\t$rest: 'lisp',\n\t\t};\n\n\t\tconst forms = '\\\\S+(?:\\\\s+\\\\S+)*';\n\n\t\tconst arglist = {\n\t\t\tpattern: RegExp(par + nestedPar + endpar),\n\t\t\tlookbehind: true,\n\t\t\tinside: {\n\t\t\t\t'rest-vars': {\n\t\t\t\t\tpattern: RegExp('&(?:body|rest)\\\\s+' + forms),\n\t\t\t\t\tinside: arg,\n\t\t\t\t},\n\t\t\t\t'other-marker-vars': {\n\t\t\t\t\tpattern: RegExp('&(?:aux|optional)\\\\s+' + forms),\n\t\t\t\t\tinside: arg,\n\t\t\t\t},\n\t\t\t\t'keys': {\n\t\t\t\t\tpattern: RegExp('&key\\\\s+' + forms + '(?:\\\\s+&allow-other-keys)?'),\n\t\t\t\t\tinside: arg,\n\t\t\t\t},\n\t\t\t\t'argument': {\n\t\t\t\t\tpattern: RegExp(symbol),\n\t\t\t\t\talias: 'variable',\n\t\t\t\t},\n\t\t\t\t'punctuation': /[()]/,\n\t\t\t},\n\t\t};\n\n\t\treturn {\n\t\t\t// Three or four semicolons are considered a heading.\n\t\t\t// See https://www.gnu.org/software/emacs/manual/html_node/elisp/Comment-Tips.html\n\t\t\t'heading': {\n\t\t\t\tpattern: /;;;.*/,\n\t\t\t\talias: ['comment', 'title'],\n\t\t\t},\n\t\t\t'comment': /;.*/,\n\t\t\t'string': {\n\t\t\t\tpattern: /\"(?:[^\"\\\\]|\\\\.)*\"/,\n\t\t\t\tgreedy: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'argument': /[-A-Z]+(?=[.,\\s])/,\n\t\t\t\t\t'symbol': RegExp('`' + symbol + \"'\"),\n\t\t\t\t},\n\t\t\t},\n\t\t\t'quoted-symbol': {\n\t\t\t\tpattern: RegExp(\"#?'\" + symbol),\n\t\t\t\talias: ['variable', 'symbol'],\n\t\t\t},\n\t\t\t'lisp-property': {\n\t\t\t\tpattern: RegExp(':' + symbol),\n\t\t\t\talias: 'property',\n\t\t\t},\n\t\t\t'splice': {\n\t\t\t\tpattern: RegExp(',@?' + symbol),\n\t\t\t\talias: ['symbol', 'variable'],\n\t\t\t},\n\t\t\t'keyword': [\n\t\t\t\t{\n\t\t\t\t\tpattern: RegExp(\n\t\t\t\t\t\tpar +\n\t\t\t\t\t\t\t'(?:and|(?:cl-)?letf|cl-loop|cond|cons|error|if|(?:lexical-)?let\\\\*?|message|not|null|or|provide|require|setq|unless|use-package|when|while)' +\n\t\t\t\t\t\t\tspace\n\t\t\t\t\t),\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpattern: RegExp(\n\t\t\t\t\t\tpar + '(?:append|by|collect|concat|do|finally|for|in|return)' + space\n\t\t\t\t\t),\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t},\n\t\t\t],\n\t\t\t'declare': {\n\t\t\t\tpattern: simple_form(/declare/.source),\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'keyword',\n\t\t\t},\n\t\t\t'interactive': {\n\t\t\t\tpattern: simple_form(/interactive/.source),\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'keyword',\n\t\t\t},\n\t\t\t'boolean': {\n\t\t\t\tpattern: primitive(/nil|t/.source),\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'number': {\n\t\t\t\tpattern: primitive(/[-+]?\\d+(?:\\.\\d*)?/.source),\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'defvar': {\n\t\t\t\tpattern: RegExp(par + 'def(?:const|custom|group|var)\\\\s+' + symbol),\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\tkeyword: /^def[a-z]+/,\n\t\t\t\t\tvariable: RegExp(symbol),\n\t\t\t\t},\n\t\t\t},\n\t\t\t'defun': {\n\t\t\t\tpattern: RegExp(\n\t\t\t\t\tpar +\n\t\t\t\t\t\t/(?:cl-)?(?:defmacro|defun\\*?)\\s+/.source +\n\t\t\t\t\t\tsymbol +\n\t\t\t\t\t\t/\\s+\\(/.source +\n\t\t\t\t\t\tnestedPar +\n\t\t\t\t\t\t/\\)/.source\n\t\t\t\t),\n\t\t\t\tlookbehind: true,\n\t\t\t\tgreedy: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'keyword': /^(?:cl-)?def\\S+/,\n\t\t\t\t\t// See below, this property needs to be defined later so that it can\n\t\t\t\t\t// reference the language object.\n\t\t\t\t\t'arguments': {\n\t\t\t\t\t\t...arglist,\n\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\t...arglist.inside,\n\t\t\t\t\t\t\t'sublist': arglist,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t'function': {\n\t\t\t\t\t\tpattern: RegExp('(^\\\\s)' + symbol),\n\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t},\n\t\t\t\t\t'punctuation': /[()]/,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'lambda': {\n\t\t\t\tpattern: RegExp(\n\t\t\t\t\tpar + 'lambda\\\\s+\\\\(\\\\s*(?:&?' + symbol + '(?:\\\\s+&?' + symbol + ')*\\\\s*)?\\\\)'\n\t\t\t\t),\n\t\t\t\tlookbehind: true,\n\t\t\t\tgreedy: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'keyword': /^lambda/,\n\t\t\t\t\t// See below, this property needs to be defined later so that it can\n\t\t\t\t\t// reference the language object.\n\t\t\t\t\t'arguments': arglist,\n\t\t\t\t\t'punctuation': /[()]/,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'car': {\n\t\t\t\tpattern: RegExp(par + symbol),\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'punctuation': [\n\t\t\t\t// open paren, brackets, and close paren\n\t\t\t\t/(?:['`,]?\\(|[)\\[\\]])/,\n\t\t\t\t// cons\n\t\t\t\t{\n\t\t\t\t\tpattern: /(\\s)\\.(?=\\s)/,\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t},\n};\n"],"names":["lisp","id","alias","grammar","simple_form","name","RegExp","primitive","pattern","symbol","par","space","nestedPar","arg","varform","inside","argument","lookbehind","$rest","forms","arglist","keys","punctuation","heading","comment","string","greedy","splice","keyword","declare","interactive","boolean","number","defvar","variable","defun","arguments","sublist","function","lambda","car"],"mappings":"AACA,IAAeA,EAAA,CACdC,GAAI,OACJC,MAAO,CAAC,QAAS,QAAS,cAC1B,OAAAC,GAQC,SAASC,EAAaC,GACrB,OAAOC,OAAO,WAAwBD,EAAxB,gBACjB,CAOE,SAASE,EAAWC,GACnB,OAAOF,OAAO,eAA4BE,EAA5B,cACjB,CAME,MAAMC,EAAS,+BAITC,EAAM,QAGNC,EAAQ,UACRC,EACL,8FAGKC,EAAM,CACX,cAAeP,OAXD,IAAMG,GAYpBK,QAAW,CACVN,QAASF,OACR,MAAcG,EAAS,cAAqBG,EAAY,OAEzDG,OAAQ,QAETC,SAAY,CACXR,QAASF,OAAO,aAAqBG,GACrCQ,YAAY,EACZf,MAAO,YAERgB,MAAO,QAGFC,EAAQ,oBAERC,EAAU,CACfZ,QAASF,OAAOI,EAAME,EA1BR,WA2BdK,YAAY,EACZF,OAAQ,CACP,YAAa,CACZP,QAASF,OAAO,qBAAuBa,GACvCJ,OAAQF,GAET,oBAAqB,CACpBL,QAASF,OAAO,wBAA0Ba,GAC1CJ,OAAQF,GAETQ,KAAQ,CACPb,QAASF,OAAO,WAAaa,EAAQ,8BACrCJ,OAAQF,GAETG,SAAY,CACXR,QAASF,OAAOG,GAChBP,MAAO,YAERoB,YAAe,SAIjB,MAAO,CAGNC,QAAW,CACVf,QAAS,QACTN,MAAO,CAAC,UAAW,UAEpBsB,QAAW,MACXC,OAAU,CACTjB,QAAS,oBACTkB,QAAQ,EACRX,OAAQ,CACPC,SAAY,oBACZP,OAAUH,OAAO,IAAMG,EAAS,OAGlC,gBAAiB,CAChBD,QAASF,OAAO,MAAQG,GACxBP,MAAO,CAAC,WAAY,WAErB,gBAAiB,CAChBM,QAASF,OAAO,IAAMG,GACtBP,MAAO,YAERyB,OAAU,CACTnB,QAASF,OAAO,MAAQG,GACxBP,MAAO,CAAC,SAAU,aAEnB0B,QAAW,CACV,CACCpB,QAASF,OACRI,EACC,8IACAC,GAEFM,YAAY,GAEb,CACCT,QAASF,OACRI,EAAM,wDAA0DC,GAEjEM,YAAY,IAGdY,QAAW,CACVrB,QAASJ,EAAY,WACrBa,YAAY,EACZf,MAAO,WAER4B,YAAe,CACdtB,QAASJ,EAAY,eACrBa,YAAY,EACZf,MAAO,WAER6B,QAAW,CACVvB,QAASD,EAAU,SACnBU,YAAY,GAEbe,OAAU,CACTxB,QAASD,EAAU,yBACnBU,YAAY,GAEbgB,OAAU,CACTzB,QAASF,OAAOI,EAAM,oCAAsCD,GAC5DQ,YAAY,EACZF,OAAQ,CACPa,QAAS,aACTM,SAAU5B,OAAOG,KAGnB0B,MAAS,CACR3B,QAASF,OACRI,EACC,qCACAD,EACA,UACAG,EACA,OAEFK,YAAY,EACZS,QAAQ,EACRX,OAAQ,CACPa,QAAW,kBAGXQ,UAAa,IACThB,EACHL,OAAQ,IACJK,EAAQL,OACXsB,QAAWjB,IAGbkB,SAAY,CACX9B,QAASF,OAAO,SAAWG,GAC3BQ,YAAY,GAEbK,YAAe,SAGjBiB,OAAU,CACT/B,QAASF,OACRI,EAAM,yBAA2BD,EAAS,YAAcA,EAAS,eAElEQ,YAAY,EACZS,QAAQ,EACRX,OAAQ,CACPa,QAAW,UAGXQ,UAAahB,EACbE,YAAe,SAGjBkB,IAAO,CACNhC,QAASF,OAAOI,EAAMD,GACtBQ,YAAY,GAEbK,YAAe,CAEd,uBAEA,CACCd,QAAS,eACTS,YAAY,IAIf"}