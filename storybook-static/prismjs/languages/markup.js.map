{"version":3,"file":"markup.js","sources":["../../src/languages/markup.js"],"sourcesContent":["import xml from './xml.js';\n\n/**\n * Adds an inlined language to markup.\n *\n * An example of an inlined language is CSS with `<style>` tags.\n *\n * @param {string} tagName The name of the tag that contains the inlined language. This name will be treated as\n * case insensitive.\n * @param {string} lang The language key.\n * @returns {GrammarToken}\n * @example\n * inlineEmbedded('style', 'css');\n */\nfunction inlineEmbedded (tagName, lang) {\n\treturn {\n\t\tpattern: RegExp(\n\t\t\t/(<__[^>]*>)(?:<!\\[CDATA\\[(?:[^\\]]|\\](?!\\]>))*\\]\\]>|(?!<!\\[CDATA\\[)[\\s\\S])*?(?=<\\/__>)/.source.replace(\n\t\t\t\t/__/g,\n\t\t\t\t() => tagName\n\t\t\t),\n\t\t\t'i'\n\t\t),\n\t\tlookbehind: true,\n\t\tgreedy: true,\n\t\tinside: {\n\t\t\t'included-cdata': {\n\t\t\t\tpattern: /<!\\[CDATA\\[[\\s\\S]*?\\]\\]>/i,\n\t\t\t\tinside: {\n\t\t\t\t\t['language-' + lang]: {\n\t\t\t\t\t\tpattern: /(^<!\\[CDATA\\[)[\\s\\S]+?(?=\\]\\]>$)/i,\n\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\tinside: lang,\n\t\t\t\t\t},\n\t\t\t\t\t'cdata': /^<!\\[CDATA\\[|\\]\\]>$/i,\n\t\t\t\t},\n\t\t\t},\n\t\t\t['language-' + lang]: {\n\t\t\t\tpattern: /[\\s\\S]+/,\n\t\t\t\tinside: lang,\n\t\t\t},\n\t\t},\n\t};\n}\n\n/**\n * Returns a pattern to highlight languages embedded in HTML attributes.\n *\n * An example of an inlined language is CSS with `style` attributes.\n *\n * @param {string} attrName The name of the tag that contains the inlined language. This name will be treated as\n * case insensitive.\n * @param {string} lang The language key.\n * @returns {GrammarToken}\n * @example\n * attributeEmbedded('style', 'css');\n */\nfunction attributeEmbedded (attrName, lang) {\n\treturn {\n\t\tpattern: RegExp(\n\t\t\t/(^|[\"'\\s])/.source +\n\t\t\t\t'(?:' +\n\t\t\t\tattrName +\n\t\t\t\t')' +\n\t\t\t\t/\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^\\s'\">=]+(?=[\\s>]))/.source,\n\t\t\t'i'\n\t\t),\n\t\tlookbehind: true,\n\t\tinside: {\n\t\t\t'attr-name': /^[^\\s=]+/,\n\t\t\t'attr-value': {\n\t\t\t\tpattern: /=[\\s\\S]+/,\n\t\t\t\tinside: {\n\t\t\t\t\t'value': {\n\t\t\t\t\t\tpattern: /(^=\\s*([\"']|(?![\"'])))\\S[\\s\\S]*(?=\\2$)/,\n\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\talias: [lang, 'language-' + lang],\n\t\t\t\t\t\tinside: lang,\n\t\t\t\t\t},\n\t\t\t\t\t'punctuation': [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpattern: /^=/,\n\t\t\t\t\t\t\talias: 'attr-equals',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t/\"|'/,\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t};\n}\n\n/** @type {import('../types.d.ts').LanguageProto<'markup'>} */\nexport default {\n\tid: 'markup',\n\tbase: xml,\n\talias: ['html', 'svg', 'mathml'],\n\tgrammar () {\n\t\treturn {\n\t\t\t$insertBefore: {\n\t\t\t\t'cdata': {\n\t\t\t\t\t'style': inlineEmbedded('style', 'css'),\n\t\t\t\t\t'script': inlineEmbedded('script', 'javascript'),\n\t\t\t\t},\n\t\t\t\t'tag/attr-value': {\n\t\t\t\t\t'special-attr': [\n\t\t\t\t\t\tattributeEmbedded('style', 'css'),\n\t\t\t\t\t\t// add attribute support for all DOM events.\n\t\t\t\t\t\t// https://developer.mozilla.org/en-US/docs/Web/Events#Standard_events\n\t\t\t\t\t\tattributeEmbedded(\n\t\t\t\t\t\t\t/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/\n\t\t\t\t\t\t\t\t.source,\n\t\t\t\t\t\t\t'javascript'\n\t\t\t\t\t\t),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t},\n};\n\n/**\n * @typedef {import('../types.d.ts').GrammarToken} GrammarToken\n */\n"],"names":["inlineEmbedded","tagName","lang","pattern","RegExp","replace","lookbehind","greedy","inside","cdata","attributeEmbedded","attrName","value","alias","punctuation","markup","id","base","xml","grammar","$insertBefore","style","script"],"mappings":"wDAcA,SAASA,EAAgBC,EAASC,GACjC,MAAO,CACNC,QAASC,OACR,6FAA+FC,QAC9F,OACA,IAAMJ,IAEP,KAEDK,YAAY,EACZC,QAAQ,EACRC,OAAQ,CACP,iBAAkB,CACjBL,QAAS,4BACTK,OAAQ,CACP,CAAC,YAAcN,GAAO,CACrBC,QAAS,oCACTG,YAAY,EACZE,OAAQN,GAETO,MAAS,yBAGX,CAAC,YAAcP,GAAO,CACrBC,QAAS,UACTK,OAAQN,IAIZ,CAcA,SAASQ,EAAmBC,EAAUT,GACrC,MAAO,CACNC,QAASC,OACR,kBAECO,EAFD,0DAKA,KAEDL,YAAY,EACZE,OAAQ,CACP,YAAa,WACb,aAAc,CACbL,QAAS,WACTK,OAAQ,CACPI,MAAS,CACRT,QAAS,yCACTG,YAAY,EACZO,MAAO,CAACX,EAAM,YAAcA,GAC5BM,OAAQN,GAETY,YAAe,CACd,CACCX,QAAS,KACTU,MAAO,eAER,UAMN,CAGA,IAAeE,EAAA,CACdC,GAAI,SACJC,KAAMC,EACNL,MAAO,CAAC,OAAQ,MAAO,UACvBM,QAAQ,KACA,CACNC,cAAe,CACdX,MAAS,CACRY,MAASrB,EAAe,QAAS,OACjCsB,OAAUtB,EAAe,SAAU,eAEpC,iBAAkB,CACjB,eAAgB,CACfU,EAAkB,QAAS,OAG3BA,EACC,yNAEA"}