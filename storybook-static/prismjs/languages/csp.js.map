{"version":3,"file":"csp.js","sources":["../../src/languages/csp.js"],"sourcesContent":["/** @type {import('../types.d.ts').LanguageProto<'csp'>} */\nexport default {\n\tid: 'csp',\n\tgrammar () {\n\t\t/**\n\t\t * Original by Scott Helme.\n\t\t *\n\t\t * Reference: https://scotthelme.co.uk/csp-cheat-sheet/\n\t\t *\n\t\t * Supports the following:\n\t\t *  - https://www.w3.org/TR/CSP1/\n\t\t *  - https://www.w3.org/TR/CSP2/\n\t\t *  - https://www.w3.org/TR/CSP3/\n\t\t */\n\n\t\t/**\n\t\t * @param {string} source\n\t\t * @returns {RegExp}\n\t\t */\n\t\tfunction value (source) {\n\t\t\treturn RegExp(/([ \\t])/.source + '(?:' + source + ')' + /(?=[\\s;]|$)/.source, 'i');\n\t\t}\n\n\t\treturn {\n\t\t\t'directive': {\n\t\t\t\tpattern:\n\t\t\t\t\t/(^|[\\s;])(?:base-uri|block-all-mixed-content|(?:child|connect|default|font|frame|img|manifest|media|object|prefetch|script|style|worker)-src|disown-opener|form-action|frame-(?:ancestors|options)|input-protection(?:-(?:clip|selectors))?|navigate-to|plugin-types|policy-uri|referrer|reflected-xss|report-(?:to|uri)|require-sri-for|sandbox|(?:script|style)-src-(?:attr|elem)|upgrade-insecure-requests)(?=[\\s;]|$)/i,\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'property',\n\t\t\t},\n\t\t\t'scheme': {\n\t\t\t\tpattern: value(/[a-z][a-z0-9.+-]*:/.source),\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'none': {\n\t\t\t\tpattern: value(/'none'/.source),\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'keyword',\n\t\t\t},\n\t\t\t'nonce': {\n\t\t\t\tpattern: value(/'nonce-[-+/\\w=]+'/.source),\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'number',\n\t\t\t},\n\t\t\t'hash': {\n\t\t\t\tpattern: value(/'sha(?:256|384|512)-[-+/\\w=]+'/.source),\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'number',\n\t\t\t},\n\t\t\t'host': {\n\t\t\t\tpattern: value(\n\t\t\t\t\t/[a-z][a-z0-9.+-]*:\\/\\/[^\\s;,']*/.source +\n\t\t\t\t\t\t'|' +\n\t\t\t\t\t\t/\\*[^\\s;,']*/.source +\n\t\t\t\t\t\t'|' +\n\t\t\t\t\t\t/[a-z0-9-]+(?:\\.[a-z0-9-]+)+(?::[\\d*]+)?(?:\\/[^\\s;,']*)?/.source\n\t\t\t\t),\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'url',\n\t\t\t\tinside: {\n\t\t\t\t\t'important': /\\*/,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'keyword': [\n\t\t\t\t{\n\t\t\t\t\tpattern: value(/'unsafe-[a-z-]+'/.source),\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\talias: 'unsafe',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpattern: value(/'[a-z-]+'/.source),\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\talias: 'safe',\n\t\t\t\t},\n\t\t\t],\n\t\t\t'punctuation': /;/,\n\t\t};\n\t},\n};\n"],"names":["csp","id","grammar","value","source","RegExp","directive","pattern","lookbehind","alias","scheme","none","nonce","hash","host","inside","important","keyword","punctuation"],"mappings":"AACA,IAAeA,EAAA,CACdC,GAAI,MACJ,OAAAC,GAgBC,SAASC,EAAOC,GACf,OAAOC,OAAO,aAA2BD,EAA3B,gBAAgE,IACjF,CAEE,MAAO,CACNE,UAAa,CACZC,QACC,6ZACDC,YAAY,EACZC,MAAO,YAERC,OAAU,CACTH,QAASJ,EAAM,sBACfK,YAAY,GAEbG,KAAQ,CACPJ,QAASJ,EAAM,UACfK,YAAY,EACZC,MAAO,WAERG,MAAS,CACRL,QAASJ,EAAM,sBACfK,YAAY,EACZC,MAAO,UAERI,KAAQ,CACPN,QAASJ,EAAM,mCACfK,YAAY,EACZC,MAAO,UAERK,KAAQ,CACPP,QAASJ,EACR,0GAMDK,YAAY,EACZC,MAAO,MACPM,OAAQ,CACPC,UAAa,OAGfC,QAAW,CACV,CACCV,QAASJ,EAAM,oBACfK,YAAY,EACZC,MAAO,UAER,CACCF,QAASJ,EAAM,aACfK,YAAY,EACZC,MAAO,SAGTS,YAAe,IAEhB"}