{"version":3,"file":"pug.js","sources":["../../src/languages/pug.js"],"sourcesContent":["import javascript from './javascript.js';\nimport markup from './markup.js';\n\n/** @type {import('../types.d.ts').LanguageProto<'pug'>} */\nexport default {\n\tid: 'pug',\n\trequire: [markup, javascript],\n\tgrammar () {\n\t\t// TODO:\n\t\t// - Add CSS highlighting inside <style> tags\n\t\t// - Add support for multi-line code blocks\n\t\t// - Add support for interpolation #{} and !{}\n\t\t// - Add support for tag interpolation #[]\n\t\t// - Add explicit support for plain text using |\n\t\t// - Add support for markup embedded in plain text\n\n\t\tconst filter_pattern =\n\t\t\t/(^([\\t ]*)):<filter_name>(?:(?:\\r?\\n|\\r(?!\\n))(?:\\2[\\t ].+|\\s*?(?=\\r?\\n|\\r)))+/.source;\n\n\t\t// Non exhaustive list of available filters and associated languages\n\t\tconst filters = [\n\t\t\t{ filter: 'atpl', language: 'twig' },\n\t\t\t{ filter: 'coffee', language: 'coffeescript' },\n\t\t\t'ejs',\n\t\t\t'handlebars',\n\t\t\t'less',\n\t\t\t'livescript',\n\t\t\t'markdown',\n\t\t\t{ filter: 'sass', language: 'scss' },\n\t\t\t'stylus',\n\t\t];\n\n\t\tconst all_filters = /** @type {import('../types.d.ts').GrammarTokens} */ ({});\n\t\tfor (const filterItem of filters) {\n\t\t\tconst { filter, language } =\n\t\t\t\ttypeof filterItem === 'string'\n\t\t\t\t\t? { filter: filterItem, language: filterItem }\n\t\t\t\t\t: filterItem;\n\t\t\tall_filters['filter-' + filter] = {\n\t\t\t\tpattern: RegExp(\n\t\t\t\t\tfilter_pattern.replace('<filter_name>', () => filter),\n\t\t\t\t\t'm'\n\t\t\t\t),\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'filter-name': {\n\t\t\t\t\t\tpattern: /^:[\\w-]+/,\n\t\t\t\t\t\talias: 'variable',\n\t\t\t\t\t},\n\t\t\t\t\t'text': {\n\t\t\t\t\t\tpattern: /\\S[\\s\\S]*/,\n\t\t\t\t\t\talias: [language, 'language-' + language],\n\t\t\t\t\t\tinside: language,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\t// Multiline stuff should appear before the rest\n\n\t\t\t// This handles both single-line and multi-line comments\n\t\t\t'comment': {\n\t\t\t\tpattern: /(^([\\t ]*))\\/\\/.*(?:(?:\\r?\\n|\\r)\\2[\\t ].+)*/m,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\n\t\t\t// All the tag-related part is in lookbehind\n\t\t\t// so that it can be highlighted by the \"tag\" pattern\n\t\t\t'multiline-script': {\n\t\t\t\tpattern:\n\t\t\t\t\t/(^([\\t ]*)script\\b.*\\.[\\t ]*)(?:(?:\\r?\\n|\\r(?!\\n))(?:\\2[\\t ].+|\\s*?(?=\\r?\\n|\\r)))+/m,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: 'javascript',\n\t\t\t},\n\n\t\t\t// See at the end of the file for known filters\n\t\t\t'filter': {\n\t\t\t\tpattern: /(^([\\t ]*)):.+(?:(?:\\r?\\n|\\r(?!\\n))(?:\\2[\\t ].+|\\s*?(?=\\r?\\n|\\r)))+/m,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'filter-name': {\n\t\t\t\t\t\tpattern: /^:[\\w-]+/,\n\t\t\t\t\t\talias: 'variable',\n\t\t\t\t\t},\n\t\t\t\t\t'text': /\\S[\\s\\S]*/,\n\t\t\t\t},\n\t\t\t},\n\n\t\t\t'multiline-plain-text': {\n\t\t\t\tpattern:\n\t\t\t\t\t/(^([\\t ]*)[\\w\\-#.]+\\.[\\t ]*)(?:(?:\\r?\\n|\\r(?!\\n))(?:\\2[\\t ].+|\\s*?(?=\\r?\\n|\\r)))+/m,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'markup': {\n\t\t\t\tpattern: /(^[\\t ]*)<.+/m,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: 'markup',\n\t\t\t},\n\t\t\t'doctype': {\n\t\t\t\tpattern: /((?:^|\\n)[\\t ]*)doctype(?: .+)?/,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\n\t\t\t// This handle all conditional and loop keywords\n\t\t\t'flow-control': {\n\t\t\t\tpattern: /(^[\\t ]*)(?:case|default|each|else|if|unless|when|while)\\b(?: .+)?/m,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'each': {\n\t\t\t\t\t\tpattern: /^each .+? in\\b/,\n\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\t'keyword': /\\b(?:each|in)\\b/,\n\t\t\t\t\t\t\t'punctuation': /,/,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t'branch': {\n\t\t\t\t\t\tpattern: /^(?:case|default|else|if|unless|when|while)\\b/,\n\t\t\t\t\t\talias: 'keyword',\n\t\t\t\t\t},\n\t\t\t\t\t$rest: 'javascript',\n\t\t\t\t},\n\t\t\t},\n\t\t\t'keyword': {\n\t\t\t\tpattern: /(^[\\t ]*)(?:append|block|extends|include|prepend)\\b.+/m,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'mixin': [\n\t\t\t\t// Declaration\n\t\t\t\t{\n\t\t\t\t\tpattern: /(^[\\t ]*)mixin .+/m,\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\tinside: {\n\t\t\t\t\t\t'keyword': /^mixin/,\n\t\t\t\t\t\t'function': /\\w+(?=\\s*\\(|\\s*$)/,\n\t\t\t\t\t\t'punctuation': /[(),.]/,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t// Usage\n\t\t\t\t{\n\t\t\t\t\tpattern: /(^[\\t ]*)\\+.+/m,\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\tinside: {\n\t\t\t\t\t\t'name': {\n\t\t\t\t\t\t\tpattern: /^\\+\\w+/,\n\t\t\t\t\t\t\talias: 'function',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t$rest: 'javascript',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\t'script': {\n\t\t\t\tpattern: /(^[\\t ]*script(?:(?:&[^(]+)?\\([^)]+\\))*[\\t ]).+/m,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: 'javascript',\n\t\t\t},\n\n\t\t\t'plain-text': {\n\t\t\t\tpattern: /(^[\\t ]*(?!-)[\\w\\-#.]*[\\w\\-](?:(?:&[^(]+)?\\([^)]+\\))*\\/?[\\t ]).+/m,\n\t\t\t\tlookbehind: true,\n\t\t\t},\n\t\t\t'tag': {\n\t\t\t\tpattern: /(^[\\t ]*)(?!-)[\\w\\-#.]*[\\w\\-](?:(?:&[^(]+)?\\([^)]+\\))*\\/?:?/m,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'attributes': [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpattern: /&[^(]+\\([^)]+\\)/,\n\t\t\t\t\t\t\tinside: 'javascript',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpattern: /\\([^)]+\\)/,\n\t\t\t\t\t\t\tinside: {\n\t\t\t\t\t\t\t\t'attr-value': {\n\t\t\t\t\t\t\t\t\tpattern: /(=\\s*(?!\\s))(?:\\{[^}]*\\}|[^,)\\r\\n]+)/,\n\t\t\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\t\t\tinside: 'javascript',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'attr-name': /[\\w-]+(?=\\s*!?=|\\s*[,)])/,\n\t\t\t\t\t\t\t\t'punctuation': /[!=(),]+/,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t'punctuation': /:/,\n\t\t\t\t\t'attr-id': /#[\\w\\-]+/,\n\t\t\t\t\t'attr-class': /\\.[\\w\\-]+/,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'code': [\n\t\t\t\t{\n\t\t\t\t\tpattern: /(^[\\t ]*(?:-|!?=)).+/m,\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\tinside: 'javascript',\n\t\t\t\t},\n\t\t\t],\n\t\t\t'punctuation': /[.\\-!=|]+/,\n\t\t\t$insertBefore: {\n\t\t\t\t'filter': all_filters,\n\t\t\t},\n\t\t};\n\t},\n};\n"],"names":["pug","id","require","markup","javascript","grammar","filters","filter","language","all_filters","filterItem","pattern","RegExp","replace","lookbehind","inside","alias","text","comment","doctype","each","keyword","punctuation","branch","$rest","mixin","function","name","script","tag","attributes","code","$insertBefore"],"mappings":"+JAIA,IAAeA,EAAA,CACdC,GAAI,MACJC,QAAS,CAACC,EAAQC,GAClB,OAAAC,GASC,MAIMC,EAAU,CACf,CAAEC,OAAQ,OAAQC,SAAU,QAC5B,CAAED,OAAQ,SAAUC,SAAU,gBAC9B,MACA,aACA,OACA,aACA,WACA,CAAED,OAAQ,OAAQC,SAAU,QAC5B,UAGKC,EAAoE,CAAE,EAC5E,IAAK,MAAMC,KAAcJ,EAAS,CACjC,MAAMC,OAAEA,EAAMC,SAAEA,GACO,iBAAfE,EACJ,CAAEH,OAAQG,EAAYF,SAAUE,GAChCA,EACJD,EAAY,UAAYF,GAAU,CACjCI,QAASC,OAtBV,mFAuBiBC,QAAQ,iBAAiB,IAAMN,IAC9C,KAEDO,YAAY,EACZC,OAAQ,CACP,cAAe,CACdJ,QAAS,WACTK,MAAO,YAERC,KAAQ,CACPN,QAAS,YACTK,MAAO,CAACR,EAAU,YAAcA,GAChCO,OAAQP,IAId,CAEE,MAAO,CAINU,QAAW,CACVP,QAAS,+CACTG,YAAY,GAKb,mBAAoB,CACnBH,QACC,sFACDG,YAAY,EACZC,OAAQ,cAITR,OAAU,CACTI,QAAS,uEACTG,YAAY,EACZC,OAAQ,CACP,cAAe,CACdJ,QAAS,WACTK,MAAO,YAERC,KAAQ,cAIV,uBAAwB,CACvBN,QACC,qFACDG,YAAY,GAEbX,OAAU,CACTQ,QAAS,gBACTG,YAAY,EACZC,OAAQ,UAETI,QAAW,CACVR,QAAS,kCACTG,YAAY,GAIb,eAAgB,CACfH,QAAS,sEACTG,YAAY,EACZC,OAAQ,CACPK,KAAQ,CACPT,QAAS,iBACTI,OAAQ,CACPM,QAAW,kBACXC,YAAe,MAGjBC,OAAU,CACTZ,QAAS,gDACTK,MAAO,WAERQ,MAAO,eAGTH,QAAW,CACVV,QAAS,yDACTG,YAAY,GAEbW,MAAS,CAER,CACCd,QAAS,qBACTG,YAAY,EACZC,OAAQ,CACPM,QAAW,SACXK,SAAY,oBACZJ,YAAe,WAIjB,CACCX,QAAS,iBACTG,YAAY,EACZC,OAAQ,CACPY,KAAQ,CACPhB,QAAS,SACTK,MAAO,YAERQ,MAAO,gBAIVI,OAAU,CACTjB,QAAS,mDACTG,YAAY,EACZC,OAAQ,cAGT,aAAc,CACbJ,QAAS,oEACTG,YAAY,GAEbe,IAAO,CACNlB,QAAS,+DACTG,YAAY,EACZC,OAAQ,CACPe,WAAc,CACb,CACCnB,QAAS,kBACTI,OAAQ,cAET,CACCJ,QAAS,YACTI,OAAQ,CACP,aAAc,CACbJ,QAAS,uCACTG,YAAY,EACZC,OAAQ,cAET,YAAa,2BACbO,YAAe,cAIlBA,YAAe,IACf,UAAW,WACX,aAAc,cAGhBS,KAAQ,CACP,CACCpB,QAAS,wBACTG,YAAY,EACZC,OAAQ,eAGVO,YAAe,YACfU,cAAe,CACdzB,OAAUE,GAGZ"}